1. SUPABASE SCHEMA - All foreign key relationships

| table_name                    | column_name        | foreign_table_name    | foreign_column_name | constraint_name                               |
| ----------------------------- | ------------------ | --------------------- | ------------------- | --------------------------------------------- |
| chat_group_invitations        | group_id           | chat_groups           | id                  | chat_group_invitations_group_id_fkey          |
| chat_group_invitations        | invitee_id         | profiles              | id                  | chat_group_invitations_invitee_id_fkey        |
| chat_group_invitations        | inviter_id         | profiles              | id                  | chat_group_invitations_inviter_id_fkey        |
| chat_group_members            | group_id           | chat_groups           | id                  | chat_group_members_group_id_fkey              |
| chat_group_members            | user_id            | profiles              | id                  | chat_group_members_user_id_fkey               |
| chat_groups                   | creator_id         | profiles              | id                  | chat_groups_creator_id_fkey                   |
| chat_messages                 | group_id           | chat_groups           | id                  | chat_messages_group_id_fkey                   |
| chat_messages                 | sender_id          | profiles              | id                  | chat_messages_sender_id_fkey                  |
| friend_requests               | recipient_id       | profiles              | id                  | friend_requests_recipient_id_fkey             |
| friend_requests               | sender_id          | profiles              | id                  | friend_requests_sender_id_fkey                |
| messages                      | receiver_id        | profiles              | id                  | messages_receiver_id_fkey                     |
| messages                      | sender_id          | profiles              | id                  | messages_sender_id_fkey                       |
| shared_trade_comments         | parent_id          | shared_trade_comments | id                  | shared_trade_comments_parent_id_fkey          |
| shared_trade_comments         | shared_trade_id    | shared_trades         | id                  | shared_trade_comments_shared_trade_id_fkey    |
| shared_trade_likes            | shared_trade_id    | shared_trades         | id                  | shared_trade_likes_shared_trade_id_fkey       |
| shared_trades                 | original_trade_id  | trades                | id                  | shared_trades_original_trade_id_fkey          |
| shared_trades                 | recipient_id       | profiles              | id                  | shared_trades_recipient_id_fkey               |
| shared_trades                 | sharer_id          | profiles              | id                  | shared_trades_sharer_id_fkey                  |
| shared_trades                 | trade_id           | trades                | id                  | shared_trades_trade_id_fkey                   |
| support_replies               | admin_id           | profiles              | id                  | support_replies_admin_id_fkey                 |
| support_replies               | support_request_id | support_requests      | id                  | support_replies_support_request_id_fkey       |
| support_requests              | last_replied_by    | profiles              | id                  | support_requests_last_replied_by_fkey         |
| support_requests              | user_id            | profiles              | id                  | support_requests_user_id_fkey                 |
| tda_analysis_history          | analysis_id        | top_down_analyses     | id                  | tda_analysis_history_analysis_id_fkey         |
| tda_analysis_history          | performed_by       | profiles              | id                  | tda_analysis_history_performed_by_fkey        |
| tda_announcements             | analysis_id        | top_down_analyses     | id                  | tda_announcements_analysis_id_fkey            |
| tda_answers                   | analysis_id        | top_down_analyses     | id                  | tda_answers_analysis_id_fkey                  |
| tda_answers                   | question_id        | tda_questions         | id                  | tda_answers_question_id_fkey                  |
| tda_screenshots               | analysis_id        | top_down_analyses     | id                  | tda_screenshots_analysis_id_fkey              |
| tda_timeframe_analyses        | analysis_id        | top_down_analyses     | id                  | tda_timeframe_analyses_analysis_id_fkey       |
| top_down_analyses             | user_id            | profiles              | id                  | top_down_analyses_user_id_fkey                |
| trade_setup_comment_reactions | comment_id         | trade_setup_comments  | id                  | trade_setup_comment_reactions_comment_id_fkey |
| trade_setup_comment_reactions | user_id            | profiles              | id                  | trade_setup_comment_reactions_user_id_fkey    |
| trade_setup_comments          | parent_id          | trade_setup_comments  | id                  | trade_setup_comments_parent_id_fkey           |
| trade_setup_comments          | trade_setup_id     | trade_setups          | id                  | trade_setup_comments_trade_setup_id_fkey      |
| trade_setup_comments          | user_id            | profiles              | id                  | trade_setup_comments_user_id_fkey             |
| trade_setup_dislikes          | trade_setup_id     | trade_setups          | id                  | trade_setup_dislikes_trade_setup_id_fkey      |
| trade_setup_dislikes          | user_id            | profiles              | id                  | trade_setup_dislikes_user_id_fkey             |
| trade_setup_likes             | trade_setup_id     | trade_setups          | id                  | trade_setup_likes_trade_setup_id_fkey         |
| trade_setup_likes             | user_id            | profiles              | id                  | trade_setup_likes_user_id_fkey                |
| trade_setup_tags              | setup_id           | trade_setups          | id                  | trade_setup_tags_setup_id_fkey                |
| trade_setups                  | user_id            | profiles              | id                  | trade_setups_user_id_fkey                     |
| trader_friends                | action_user_id     | profiles              | id                  | trader_friends_action_user_id_fkey            |
| trader_friends                | user1_id           | profiles              | id                  | trader_friends_user1_id_fkey                  |
| trader_friends                | user2_id           | profiles              | id                  | trader_friends_user2_id_fkey                  |
| trades                        | user_id            | profiles              | id                  | trades_user_id_fkey                           |
| user_presence                 | user_id            | profiles              | id                  | user_presence_user_id_fkey                    |
| user_settings                 | user_id            | profiles              | id                  | user_settings_user_id_fkey                    |

2. TRADES TABLE STRUCTURE

| column_name       | data_type                | is_nullable | column_default       | character_maximum_length | numeric_precision | numeric_scale |
| ----------------- | ------------------------ | ----------- | -------------------- | ------------------------ | ----------------- | ------------- |
| id                | uuid                     | NO          | uuid_generate_v4()   | null                     | null              | null          |
| user_id           | uuid                     | YES         | null                 | null                     | null              | null          |
| currency_pair     | text                     | NO          | null                 | null                     | null              | null          |
| trade_type        | USER-DEFINED             | NO          | null                 | null                     | null              | null          |
| entry_price       | numeric                  | NO          | null                 | null                     | 18                | 8             |
| exit_price        | numeric                  | YES         | null                 | null                     | 18                | 8             |
| stop_loss         | numeric                  | YES         | null                 | null                     | 18                | 8             |
| take_profit       | numeric                  | YES         | null                 | null                     | 18                | 8             |
| lot_size          | numeric                  | NO          | null                 | null                     | 18                | 8             |
| risk_reward_ratio | numeric                  | YES         | null                 | null                     | 5                 | 2             |
| profit_loss       | numeric                  | YES         | null                 | null                     | 18                | 8             |
| pnl_percentage    | numeric                  | YES         | null                 | null                     | 10                | 2             |
| status            | USER-DEFINED             | YES         | 'OPEN'::trade_status | null                     | null              | null          |
| date              | timestamp with time zone | YES         | now()                | null                     | null              | null          |
| exit_time         | timestamp with time zone | YES         | null                 | null                     | null              | null          |
| notes             | text                     | YES         | null                 | null                     | null              | null          |
| image_urls        | ARRAY                    | YES         | null                 | null                     | null              | null          |
| tags              | ARRAY                    | YES         | null                 | null                     | null              | null          |
| created_at        | timestamp with time zone | YES         | now()                | null                     | null              | null          |
| updated_at        | timestamp with time zone | YES         | now()                | null                     | null              | null          |
| entry_time        | timestamp with time zone | YES         | null                 | null                     | null              | null          |
| duration          | integer                  | YES         | null                 | null                     | 32                | 0             |
| pips              | numeric                  | YES         | null                 | null                     | 10                | 2             |
| currency          | text                     | NO          | 'AUD'::text          | null                     | null              | null          |

3. PROFILES TABLE STRUCTURE (RLS Policies)

| column_name        | data_type                | is_nullable | column_default      | character_maximum_length | numeric_precision | numeric_scale |
| ------------------ | ------------------------ | ----------- | ------------------- | ------------------------ | ----------------- | ------------- |
| id                 | uuid                     | NO          | null                | null                     | null              | null          |
| username           | text                     | YES         | null                | null                     | null              | null          |
| email              | text                     | NO          | null                | null                     | null              | null          |
| avatar_url         | text                     | YES         | null                | null                     | null              | null          |
| bio                | text                     | YES         | null                | null                     | null              | null          |
| website            | text                     | YES         | null                | null                     | null              | null          |
| role               | USER-DEFINED             | YES         | 'TRADER'::user_role | null                     | null              | null          |
| performance_rank   | integer                  | YES         | null                | null                     | 32                | 0             |
| win_rate           | numeric                  | YES         | null                | null                     | 5                 | 2             |
| created_at         | timestamp with time zone | YES         | now()               | null                     | null              | null          |
| updated_at         | timestamp with time zone | YES         | now()               | null                     | null              | null          |
| trader_status      | text                     | YES         | null                | null                     | null              | null          |
| trader_type        | text                     | YES         | null                | null                     | null              | null          |
| years_experience   | text                     | YES         | null                | null                     | null              | null          |
| trading_frequency  | text                     | YES         | null                | null                     | null              | null          |
| markets            | text                     | YES         | null                | null                     | null              | null          |
| trading_goal       | text                     | YES         | null                | null                     | null              | null          |
| trading_challenges | text                     | YES         | null                | null                     | null              | null          |
| first_name         | text                     | YES         | null                | null                     | null              | null          |
| last_name          | text                     | YES         | null                | null                     | null              | null          |

RLS POLICIES:

| policyname             | permissive | roles           | cmd    | qual              | with_check        |
| ---------------------- | ---------- | --------------- | ------ | ----------------- | ----------------- |
| profiles_delete_policy | PERMISSIVE | {authenticated} | DELETE | (auth.uid() = id) | null              |
| profiles_insert_policy | PERMISSIVE | {authenticated} | INSERT | null              | (auth.uid() = id) |
| profiles_select_policy | PERMISSIVE | {authenticated} | SELECT | true              | null              |
| profiles_update_policy | PERMISSIVE | {authenticated} | UPDATE | (auth.uid() = id) | (auth.uid() = id) |

4. SUPABASE CHAT TABLES and RLS

| schemaname | tablename              | policyname                                | permissive | roles           | cmd    | qual                                                                                                                                                                                           | with_check                                                                                                                                  |
| ---------- | ---------------------- | ----------------------------------------- | ---------- | --------------- | ------ | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------- |
| public     | chat_group_invitations | Users can view invitations sent to them   | PERMISSIVE | {public}        | SELECT | (auth.uid() = invitee_id)                                                                                                                                                                      | null                                                                                                                                        |
| public     | chat_group_invitations | member_invitation_access                  | PERMISSIVE | {authenticated} | SELECT | (group_id IN ( SELECT chat_group_members.group_id
   FROM chat_group_members
  WHERE (chat_group_members.user_id = auth.uid())))                                                               | null                                                                                                                                        |
| public     | chat_group_invitations | user_invitations_only                     | PERMISSIVE | {authenticated} | ALL    | ((invitee_id = auth.uid()) OR (inviter_id = auth.uid()))                                                                                                                                       | (inviter_id = auth.uid())                                                                                                                   |
| public     | chat_group_members     | Group creators can add members            | PERMISSIVE | {public}        | INSERT | null                                                                                                                                                                                           | (EXISTS ( SELECT 1
   FROM chat_groups
  WHERE ((chat_groups.id = chat_group_members.group_id) AND (chat_groups.creator_id = auth.uid())))) |
| public     | chat_group_members     | Group members can view group members      | PERMISSIVE | {public}        | SELECT | (EXISTS ( SELECT 1
   FROM chat_group_members chat_group_members_1
  WHERE ((chat_group_members_1.group_id = chat_group_members_1.group_id) AND (chat_group_members_1.user_id = auth.uid())))) | null                                                                                                                                        |
| public     | chat_group_members     | user_memberships_only                     | PERMISSIVE | {authenticated} | ALL    | (user_id = auth.uid())                                                                                                                                                                         | (user_id = auth.uid())                                                                                                                      |
| public     | chat_groups            | Users can create groups                   | PERMISSIVE | {public}        | INSERT | null                                                                                                                                                                                           | (auth.uid() = creator_id)                                                                                                                   |
| public     | chat_groups            | Users can view groups they are members of | PERMISSIVE | {public}        | SELECT | (EXISTS ( SELECT 1
   FROM chat_group_members
  WHERE ((chat_group_members.group_id = chat_groups.id) AND (chat_group_members.user_id = auth.uid()))))                                         | null                                                                                                                                        |
| public     | chat_groups            | member_group_access                       | PERMISSIVE | {authenticated} | SELECT | (id IN ( SELECT chat_group_members.group_id
   FROM chat_group_members
  WHERE (chat_group_members.user_id = auth.uid())))                                                                     | null                                                                                                                                        |
| public     | chat_groups            | user_groups_only                          | PERMISSIVE | {authenticated} | ALL    | (creator_id = auth.uid())                                                                                                                                                                      | (creator_id = auth.uid())                                                                                                                   |
| public     | chat_messages          | member_message_access                     | PERMISSIVE | {authenticated} | SELECT | (group_id IN ( SELECT chat_group_members.group_id
   FROM chat_group_members
  WHERE (chat_group_members.user_id = auth.uid())))                                                               | null                                                                                                                                        |
| public     | chat_messages          | user_messages_only                        | PERMISSIVE | {authenticated} | ALL    | (sender_id = auth.uid())                                                                                                                                                                       | (sender_id = auth.uid())                                                                                                                    |

5. SUPABASE all tables and their columns

| table_name                    | column_name             | data_type                | is_nullable | column_default             | character_maximum_length | numeric_precision | numeric_scale |
| ----------------------------- | ----------------------- | ------------------------ | ----------- | -------------------------- | ------------------------ | ----------------- | ------------- |
| audit_logs                    | id                      | uuid                     | NO          | uuid_generate_v4()         | null                     | null              | null          |
| audit_logs                    | user_id                 | uuid                     | YES         | null                       | null                     | null              | null          |
| audit_logs                    | action                  | text                     | NO          | ''::text                   | null                     | null              | null          |
| audit_logs                    | entity_type             | text                     | YES         | null                       | null                     | null              | null          |
| audit_logs                    | entity_id               | uuid                     | YES         | null                       | null                     | null              | null          |
| audit_logs                    | old_values              | jsonb                    | YES         | null                       | null                     | null              | null          |
| audit_logs                    | new_values              | jsonb                    | YES         | null                       | null                     | null              | null          |
| audit_logs                    | ip_address              | text                     | YES         | null                       | null                     | null              | null          |
| audit_logs                    | user_agent              | text                     | YES         | null                       | null                     | null              | null          |
| audit_logs                    | created_at              | timestamp with time zone | YES         | now()                      | null                     | null              | null          |
| audit_logs                    | event_type              | text                     | YES         | null                       | null                     | null              | null          |
| audit_logs                    | table_name              | text                     | YES         | null                       | null                     | null              | null          |
| audit_logs                    | record_id               | uuid                     | YES         | null                       | null                     | null              | null          |
| audit_logs                    | old_data                | jsonb                    | YES         | null                       | null                     | null              | null          |
| audit_logs                    | new_data                | jsonb                    | YES         | null                       | null                     | null              | null          |
| chat_group_invitations        | id                      | uuid                     | NO          | uuid_generate_v4()         | null                     | null              | null          |
| chat_group_invitations        | group_id                | uuid                     | YES         | null                       | null                     | null              | null          |
| chat_group_invitations        | inviter_id              | uuid                     | YES         | null                       | null                     | null              | null          |
| chat_group_invitations        | invitee_id              | uuid                     | YES         | null                       | null                     | null              | null          |
| chat_group_invitations        | status                  | text                     | YES         | 'pending'::text            | null                     | null              | null          |
| chat_group_invitations        | created_at              | timestamp with time zone | YES         | now()                      | null                     | null              | null          |
| chat_group_invitations        | updated_at              | timestamp with time zone | YES         | now()                      | null                     | null              | null          |
| chat_group_members            | id                      | uuid                     | NO          | uuid_generate_v4()         | null                     | null              | null          |
| chat_group_members            | group_id                | uuid                     | YES         | null                       | null                     | null              | null          |
| chat_group_members            | user_id                 | uuid                     | YES         | null                       | null                     | null              | null          |
| chat_group_members            | joined_at               | timestamp with time zone | YES         | now()                      | null                     | null              | null          |
| chat_group_members            | last_read_at            | timestamp with time zone | YES         | now()                      | null                     | null              | null          |
| chat_group_members            | is_pinned               | boolean                  | YES         | false                      | null                     | null              | null          |
| chat_group_members            | is_muted                | boolean                  | YES         | false                      | null                     | null              | null          |
| chat_groups                   | id                      | uuid                     | NO          | uuid_generate_v4()         | null                     | null              | null          |
| chat_groups                   | name                    | text                     | NO          | null                       | null                     | null              | null          |
| chat_groups                   | is_direct               | boolean                  | YES         | false                      | null                     | null              | null          |
| chat_groups                   | creator_id              | uuid                     | YES         | null                       | null                     | null              | null          |
| chat_groups                   | avatar_url              | text                     | YES         | null                       | null                     | null              | null          |
| chat_groups                   | created_at              | timestamp with time zone | YES         | now()                      | null                     | null              | null          |
| chat_groups                   | updated_at              | timestamp with time zone | YES         | now()                      | null                     | null              | null          |
| chat_messages                 | id                      | uuid                     | NO          | uuid_generate_v4()         | null                     | null              | null          |
| chat_messages                 | group_id                | uuid                     | YES         | null                       | null                     | null              | null          |
| chat_messages                 | sender_id               | uuid                     | YES         | null                       | null                     | null              | null          |
| chat_messages                 | content                 | text                     | NO          | null                       | null                     | null              | null          |
| chat_messages                 | message_type            | text                     | YES         | 'text'::text               | null                     | null              | null          |
| chat_messages                 | created_at              | timestamp with time zone | YES         | now()                      | null                     | null              | null          |
| chat_messages                 | updated_at              | timestamp with time zone | YES         | now()                      | null                     | null              | null          |
| friend_requests               | id                      | uuid                     | NO          | uuid_generate_v4()         | null                     | null              | null          |
| friend_requests               | sender_id               | uuid                     | YES         | null                       | null                     | null              | null          |
| friend_requests               | recipient_id            | uuid                     | YES         | null                       | null                     | null              | null          |
| friend_requests               | status                  | text                     | YES         | 'pending'::text            | null                     | null              | null          |
| friend_requests               | created_at              | timestamp with time zone | YES         | now()                      | null                     | null              | null          |
| friend_requests               | updated_at              | timestamp with time zone | YES         | now()                      | null                     | null              | null          |
| messages                      | id                      | uuid                     | NO          | gen_random_uuid()          | null                     | null              | null          |
| messages                      | sender_id               | uuid                     | NO          | null                       | null                     | null              | null          |
| messages                      | receiver_id             | uuid                     | NO          | null                       | null                     | null              | null          |
| messages                      | content                 | text                     | NO          | null                       | null                     | null              | null          |
| messages                      | status                  | USER-DEFINED             | YES         | 'SENT'::message_status     | null                     | null              | null          |
| messages                      | is_read                 | boolean                  | YES         | false                      | null                     | null              | null          |
| messages                      | created_at              | timestamp with time zone | YES         | now()                      | null                     | null              | null          |
| messages                      | updated_at              | timestamp with time zone | YES         | now()                      | null                     | null              | null          |
| messages                      | deleted_at              | timestamp with time zone | YES         | null                       | null                     | null              | null          |
| profiles                      | id                      | uuid                     | NO          | null                       | null                     | null              | null          |
| profiles                      | username                | text                     | YES         | null                       | null                     | null              | null          |
| profiles                      | email                   | text                     | NO          | null                       | null                     | null              | null          |
| profiles                      | avatar_url              | text                     | YES         | null                       | null                     | null              | null          |
| profiles                      | bio                     | text                     | YES         | null                       | null                     | null              | null          |
| profiles                      | website                 | text                     | YES         | null                       | null                     | null              | null          |
| profiles                      | role                    | USER-DEFINED             | YES         | 'TRADER'::user_role        | null                     | null              | null          |
| profiles                      | performance_rank        | integer                  | YES         | null                       | null                     | 32                | 0             |
| profiles                      | win_rate                | numeric                  | YES         | null                       | null                     | 5                 | 2             |
| profiles                      | created_at              | timestamp with time zone | YES         | now()                      | null                     | null              | null          |
| profiles                      | updated_at              | timestamp with time zone | YES         | now()                      | null                     | null              | null          |
| profiles                      | trader_status           | text                     | YES         | null                       | null                     | null              | null          |
| profiles                      | trader_type             | text                     | YES         | null                       | null                     | null              | null          |
| profiles                      | years_experience        | text                     | YES         | null                       | null                     | null              | null          |
| profiles                      | trading_frequency       | text                     | YES         | null                       | null                     | null              | null          |
| profiles                      | markets                 | text                     | YES         | null                       | null                     | null              | null          |
| profiles                      | trading_goal            | text                     | YES         | null                       | null                     | null              | null          |
| profiles                      | trading_challenges      | text                     | YES         | null                       | null                     | null              | null          |
| profiles                      | first_name              | text                     | YES         | null                       | null                     | null              | null          |
| profiles                      | last_name               | text                     | YES         | null                       | null                     | null              | null          |
| shared_trade_comments         | id                      | uuid                     | NO          | gen_random_uuid()          | null                     | null              | null          |
| shared_trade_comments         | shared_trade_id         | uuid                     | NO          | null                       | null                     | null              | null          |
| shared_trade_comments         | user_id                 | uuid                     | NO          | null                       | null                     | null              | null          |
| shared_trade_comments         | content                 | text                     | NO          | null                       | null                     | null              | null          |
| shared_trade_comments         | created_at              | timestamp with time zone | YES         | now()                      | null                     | null              | null          |
| shared_trade_comments         | updated_at              | timestamp with time zone | YES         | now()                      | null                     | null              | null          |
| shared_trade_comments         | parent_id               | uuid                     | YES         | null                       | null                     | null              | null          |
| shared_trade_likes            | id                      | uuid                     | NO          | gen_random_uuid()          | null                     | null              | null          |
| shared_trade_likes            | shared_trade_id         | uuid                     | NO          | null                       | null                     | null              | null          |
| shared_trade_likes            | user_id                 | uuid                     | NO          | null                       | null                     | null              | null          |
| shared_trade_likes            | created_at              | timestamp with time zone | YES         | now()                      | null                     | null              | null          |
| shared_trades                 | id                      | uuid                     | NO          | gen_random_uuid()          | null                     | null              | null          |
| shared_trades                 | original_trade_id       | uuid                     | NO          | null                       | null                     | null              | null          |
| shared_trades                 | shared_by_user_id       | uuid                     | NO          | null                       | null                     | null              | null          |
| shared_trades                 | shared_with_user_id     | uuid                     | YES         | null                       | null                     | null              | null          |
| shared_trades                 | share_type              | character varying        | NO          | null                       | 20                       | null              | null          |
| shared_trades                 | forum_id                | character varying        | YES         | null                       | 50                       | null              | null          |
| shared_trades                 | is_active               | boolean                  | YES         | true                       | null                     | null              | null          |
| shared_trades                 | created_at              | timestamp with time zone | YES         | now()                      | null                     | null              | null          |
| shared_trades                 | updated_at              | timestamp with time zone | YES         | now()                      | null                     | null              | null          |
| shared_trades                 | trade_id                | uuid                     | YES         | null                       | null                     | null              | null          |
| shared_trades                 | sharer_id               | uuid                     | YES         | null                       | null                     | null              | null          |
| shared_trades                 | recipient_id            | uuid                     | YES         | null                       | null                     | null              | null          |
| support_replies               | id                      | uuid                     | NO          | uuid_generate_v4()         | null                     | null              | null          |
| support_replies               | support_request_id      | uuid                     | YES         | null                       | null                     | null              | null          |
| support_replies               | admin_id                | uuid                     | YES         | null                       | null                     | null              | null          |
| support_replies               | subject                 | text                     | NO          | null                       | null                     | null              | null          |
| support_replies               | message                 | text                     | NO          | null                       | null                     | null              | null          |
| support_replies               | created_at              | timestamp with time zone | YES         | now()                      | null                     | null              | null          |
| support_replies               | updated_at              | timestamp with time zone | YES         | now()                      | null                     | null              | null          |
| support_requests              | id                      | uuid                     | NO          | uuid_generate_v4()         | null                     | null              | null          |
| support_requests              | user_id                 | uuid                     | YES         | null                       | null                     | null              | null          |
| support_requests              | subject                 | text                     | NO          | null                       | null                     | null              | null          |
| support_requests              | message                 | text                     | NO          | null                       | null                     | null              | null          |
| support_requests              | status                  | text                     | YES         | 'open'::text               | null                     | null              | null          |
| support_requests              | priority                | text                     | YES         | 'medium'::text             | null                     | null              | null          |
| support_requests              | created_at              | timestamp with time zone | YES         | now()                      | null                     | null              | null          |
| support_requests              | updated_at              | timestamp with time zone | YES         | now()                      | null                     | null              | null          |
| support_requests              | last_replied_at         | timestamp with time zone | YES         | null                       | null                     | null              | null          |
| support_requests              | last_replied_by         | uuid                     | YES         | null                       | null                     | null              | null          |
| tda_analysis_history          | id                      | uuid                     | NO          | gen_random_uuid()          | null                     | null              | null          |
| tda_analysis_history          | analysis_id             | uuid                     | NO          | null                       | null                     | null              | null          |
| tda_analysis_history          | action                  | character varying        | NO          | null                       | 50                       | null              | null          |
| tda_analysis_history          | changes                 | jsonb                    | YES         | null                       | null                     | null              | null          |
| tda_analysis_history          | performed_by            | uuid                     | YES         | null                       | null                     | null              | null          |
| tda_analysis_history          | performed_at            | timestamp with time zone | YES         | now()                      | null                     | null              | null          |
| tda_announcements             | id                      | uuid                     | NO          | gen_random_uuid()          | null                     | null              | null          |
| tda_announcements             | analysis_id             | uuid                     | NO          | null                       | null                     | null              | null          |
| tda_announcements             | announcement_type       | character varying        | NO          | null                       | 20                       | null              | null          |
| tda_announcements             | announcement_text       | text                     | NO          | null                       | null                     | null              | null          |
| tda_announcements             | impact_level            | character varying        | NO          | null                       | 10                       | null              | null          |
| tda_announcements             | created_at              | timestamp with time zone | YES         | now()                      | null                     | null              | null          |
| tda_announcements             | updated_at              | timestamp with time zone | YES         | now()                      | null                     | null              | null          |
| tda_answers                   | id                      | uuid                     | NO          | gen_random_uuid()          | null                     | null              | null          |
| tda_answers                   | analysis_id             | uuid                     | NO          | null                       | null                     | null              | null          |
| tda_answers                   | question_id             | uuid                     | NO          | null                       | null                     | null              | null          |
| tda_answers                   | answer_text             | text                     | YES         | null                       | null                     | null              | null          |
| tda_answers                   | answer_value            | jsonb                    | YES         | null                       | null                     | null              | null          |
| tda_answers                   | created_at              | timestamp with time zone | YES         | now()                      | null                     | null              | null          |
| tda_questions                 | id                      | uuid                     | NO          | gen_random_uuid()          | null                     | null              | null          |
| tda_questions                 | timeframe               | USER-DEFINED             | NO          | null                       | null                     | null              | null          |
| tda_questions                 | question_text           | text                     | NO          | null                       | null                     | null              | null          |
| tda_questions                 | question_type           | character varying        | NO          | null                       | 20                       | null              | null          |
| tda_questions                 | options                 | jsonb                    | YES         | null                       | null                     | null              | null          |
| tda_questions                 | required                | boolean                  | YES         | true                       | null                     | null              | null          |
| tda_questions                 | order_index             | integer                  | NO          | null                       | null                     | 32                | 0             |
| tda_questions                 | created_at              | timestamp with time zone | YES         | now()                      | null                     | null              | null          |
| tda_questions                 | is_active               | boolean                  | YES         | true                       | null                     | null              | null          |
| tda_questions                 | info                    | text                     | YES         | null                       | null                     | null              | null          |
| tda_screenshots               | id                      | uuid                     | NO          | gen_random_uuid()          | null                     | null              | null          |
| tda_screenshots               | analysis_id             | uuid                     | NO          | null                       | null                     | null              | null          |
| tda_screenshots               | timeframe               | character varying        | NO          | null                       | 20                       | null              | null          |
| tda_screenshots               | file_url                | text                     | NO          | null                       | null                     | null              | null          |
| tda_screenshots               | file_name               | character varying        | NO          | null                       | 255                      | null              | null          |
| tda_screenshots               | file_size               | integer                  | NO          | null                       | null                     | 32                | 0             |
| tda_screenshots               | created_at              | timestamp with time zone | YES         | now()                      | null                     | null              | null          |
| tda_screenshots               | updated_at              | timestamp with time zone | YES         | now()                      | null                     | null              | null          |
| tda_timeframe_analyses        | id                      | uuid                     | NO          | gen_random_uuid()          | null                     | null              | null          |
| tda_timeframe_analyses        | analysis_id             | uuid                     | NO          | null                       | null                     | null              | null          |
| tda_timeframe_analyses        | timeframe               | USER-DEFINED             | NO          | null                       | null                     | null              | null          |
| tda_timeframe_analyses        | created_at              | timestamp with time zone | YES         | now()                      | null                     | null              | null          |
| tda_timeframe_analyses        | updated_at              | timestamp with time zone | YES         | now()                      | null                     | null              | null          |
| tda_timeframe_analyses        | analysis_data           | jsonb                    | NO          | '{}'::jsonb                | null                     | null              | null          |
| tda_timeframe_analyses        | timeframe_probability   | numeric                  | YES         | null                       | null                     | 5                 | 2             |
| tda_timeframe_analyses        | timeframe_sentiment     | character varying        | YES         | null                       | 20                       | null              | null          |
| tda_timeframe_analyses        | timeframe_strength      | numeric                  | YES         | null                       | null                     | 5                 | 2             |
| top_down_analyses             | id                      | uuid                     | NO          | gen_random_uuid()          | null                     | null              | null          |
| top_down_analyses             | user_id                 | uuid                     | NO          | null                       | null                     | null              | null          |
| top_down_analyses             | currency_pair           | character varying        | NO          | null                       | 10                       | null              | null          |
| top_down_analyses             | analysis_date           | date                     | NO          | CURRENT_DATE               | null                     | null              | null          |
| top_down_analyses             | status                  | USER-DEFINED             | NO          | 'DRAFT'::analysis_status   | null                     | null              | null          |
| top_down_analyses             | created_at              | timestamp with time zone | YES         | now()                      | null                     | null              | null          |
| top_down_analyses             | updated_at              | timestamp with time zone | YES         | now()                      | null                     | null              | null          |
| top_down_analyses             | completed_at            | timestamp with time zone | YES         | null                       | null                     | null              | null          |
| top_down_analyses             | overall_probability     | numeric                  | YES         | null                       | null                     | 5                 | 2             |
| top_down_analyses             | trade_recommendation    | USER-DEFINED             | YES         | null                       | null                     | null              | null          |
| top_down_analyses             | confidence_level        | numeric                  | YES         | null                       | null                     | 5                 | 2             |
| top_down_analyses             | risk_level              | character varying        | YES         | null                       | 20                       | null              | null          |
| top_down_analyses             | ai_summary              | text                     | YES         | null                       | null                     | null              | null          |
| top_down_analyses             | ai_reasoning            | text                     | YES         | null                       | null                     | null              | null          |
| top_down_analyses             | notes                   | text                     | YES         | null                       | null                     | null              | null          |
| top_down_analyses             | tags                    | ARRAY                    | YES         | null                       | null                     | null              | null          |
| top_down_analyses             | analysis_time           | time without time zone   | YES         | null                       | null                     | null              | null          |
| trade_setup_comment_reactions | id                      | uuid                     | NO          | gen_random_uuid()          | null                     | null              | null          |
| trade_setup_comment_reactions | comment_id              | uuid                     | NO          | null                       | null                     | null              | null          |
| trade_setup_comment_reactions | user_id                 | uuid                     | NO          | null                       | null                     | null              | null          |
| trade_setup_comment_reactions | reaction_type           | text                     | NO          | null                       | null                     | null              | null          |
| trade_setup_comment_reactions | created_at              | timestamp with time zone | YES         | now()                      | null                     | null              | null          |
| trade_setup_comment_reactions | updated_at              | timestamp with time zone | YES         | now()                      | null                     | null              | null          |
| trade_setup_comments          | id                      | uuid                     | NO          | uuid_generate_v4()         | null                     | null              | null          |
| trade_setup_comments          | trade_setup_id          | uuid                     | YES         | null                       | null                     | null              | null          |
| trade_setup_comments          | user_id                 | uuid                     | YES         | null                       | null                     | null              | null          |
| trade_setup_comments          | parent_id               | uuid                     | YES         | null                       | null                     | null              | null          |
| trade_setup_comments          | content                 | text                     | NO          | null                       | null                     | null              | null          |
| trade_setup_comments          | created_at              | timestamp with time zone | YES         | now()                      | null                     | null              | null          |
| trade_setup_comments          | updated_at              | timestamp with time zone | YES         | now()                      | null                     | null              | null          |
| trade_setup_comments          | likes_count             | integer                  | YES         | 0                          | null                     | 32                | 0             |
| trade_setup_comments          | dislikes_count          | integer                  | YES         | 0                          | null                     | 32                | 0             |
| trade_setup_comments          | is_edited               | boolean                  | YES         | false                      | null                     | null              | null          |
| trade_setup_comments          | edited_at               | timestamp with time zone | YES         | null                       | null                     | null              | null          |
| trade_setup_comments          | edit_history            | jsonb                    | YES         | '[]'::jsonb                | null                     | null              | null          |
| trade_setup_dislikes          | id                      | uuid                     | NO          | gen_random_uuid()          | null                     | null              | null          |
| trade_setup_dislikes          | trade_setup_id          | uuid                     | NO          | null                       | null                     | null              | null          |
| trade_setup_dislikes          | user_id                 | uuid                     | NO          | null                       | null                     | null              | null          |
| trade_setup_dislikes          | created_at              | timestamp with time zone | YES         | now()                      | null                     | null              | null          |
| trade_setup_likes             | id                      | uuid                     | NO          | uuid_generate_v4()         | null                     | null              | null          |
| trade_setup_likes             | trade_setup_id          | uuid                     | YES         | null                       | null                     | null              | null          |
| trade_setup_likes             | user_id                 | uuid                     | YES         | null                       | null                     | null              | null          |
| trade_setup_likes             | created_at              | timestamp with time zone | YES         | now()                      | null                     | null              | null          |
| trade_setup_tags              | id                      | uuid                     | NO          | uuid_generate_v4()         | null                     | null              | null          |
| trade_setup_tags              | setup_id                | uuid                     | YES         | null                       | null                     | null              | null          |
| trade_setup_tags              | tag                     | text                     | NO          | null                       | null                     | null              | null          |
| trade_setups                  | id                      | uuid                     | NO          | uuid_generate_v4()         | null                     | null              | null          |
| trade_setups                  | user_id                 | uuid                     | YES         | null                       | null                     | null              | null          |
| trade_setups                  | title                   | text                     | NO          | null                       | null                     | null              | null          |
| trade_setups                  | description             | text                     | YES         | null                       | null                     | null              | null          |
| trade_setups                  | currency_pair           | text                     | NO          | null                       | null                     | null              | null          |
| trade_setups                  | direction               | USER-DEFINED             | NO          | null                       | null                     | null              | null          |
| trade_setups                  | entry_price             | numeric                  | NO          | null                       | null                     | 18                | 8             |
| trade_setups                  | stop_loss               | numeric                  | YES         | null                       | null                     | 18                | 8             |
| trade_setups                  | take_profit             | numeric                  | YES         | null                       | null                     | 18                | 8             |
| trade_setups                  | risk_reward_ratio       | numeric                  | YES         | null                       | null                     | 5                 | 2             |
| trade_setups                  | chart_image_url         | text                     | YES         | null                       | null                     | null              | null          |
| trade_setups                  | is_public               | boolean                  | YES         | false                      | null                     | null              | null          |
| trade_setups                  | created_at              | timestamp with time zone | YES         | now()                      | null                     | null              | null          |
| trade_setups                  | updated_at              | timestamp with time zone | YES         | now()                      | null                     | null              | null          |
| trade_setups                  | likes_count             | integer                  | YES         | 0                          | null                     | 32                | 0             |
| trade_setups                  | comments_count          | integer                  | YES         | 0                          | null                     | 32                | 0             |
| trade_setups                  | forum_id                | text                     | YES         | null                       | null                     | null              | null          |
| trade_setups                  | forum_ids               | ARRAY                    | YES         | null                       | null                     | null              | null          |
| trade_setups                  | image_urls              | ARRAY                    | YES         | null                       | null                     | null              | null          |
| trade_setups                  | target_price            | numeric                  | YES         | null                       | null                     | 18                | 8             |
| trade_setups                  | timeframe               | text                     | YES         | null                       | null                     | null              | null          |
| trade_setups                  | tags                    | ARRAY                    | YES         | null                       | null                     | null              | null          |
| trade_setups                  | pair                    | text                     | YES         | null                       | null                     | null              | null          |
| trade_setups                  | dislikes_count          | integer                  | YES         | 0                          | null                     | 32                | 0             |
| trader_friends                | id                      | uuid                     | NO          | gen_random_uuid()          | null                     | null              | null          |
| trader_friends                | user1_id                | uuid                     | NO          | null                       | null                     | null              | null          |
| trader_friends                | user2_id                | uuid                     | NO          | null                       | null                     | null              | null          |
| trader_friends                | status                  | text                     | NO          | 'PENDING'::text            | null                     | null              | null          |
| trader_friends                | created_at              | timestamp with time zone | YES         | now()                      | null                     | null              | null          |
| trader_friends                | updated_at              | timestamp with time zone | YES         | now()                      | null                     | null              | null          |
| trader_friends                | action_user_id          | uuid                     | YES         | null                       | null                     | null              | null          |
| trades                        | id                      | uuid                     | NO          | uuid_generate_v4()         | null                     | null              | null          |
| trades                        | user_id                 | uuid                     | YES         | null                       | null                     | null              | null          |
| trades                        | currency_pair           | text                     | NO          | null                       | null                     | null              | null          |
| trades                        | trade_type              | USER-DEFINED             | NO          | null                       | null                     | null              | null          |
| trades                        | entry_price             | numeric                  | NO          | null                       | null                     | 18                | 8             |
| trades                        | exit_price              | numeric                  | YES         | null                       | null                     | 18                | 8             |
| trades                        | stop_loss               | numeric                  | YES         | null                       | null                     | 18                | 8             |
| trades                        | take_profit             | numeric                  | YES         | null                       | null                     | 18                | 8             |
| trades                        | lot_size                | numeric                  | NO          | null                       | null                     | 18                | 8             |
| trades                        | risk_reward_ratio       | numeric                  | YES         | null                       | null                     | 5                 | 2             |
| trades                        | profit_loss             | numeric                  | YES         | null                       | null                     | 18                | 8             |
| trades                        | pnl_percentage          | numeric                  | YES         | null                       | null                     | 10                | 2             |
| trades                        | status                  | USER-DEFINED             | YES         | 'OPEN'::trade_status       | null                     | null              | null          |
| trades                        | date                    | timestamp with time zone | YES         | now()                      | null                     | null              | null          |
| trades                        | exit_time               | timestamp with time zone | YES         | null                       | null                     | null              | null          |
| trades                        | notes                   | text                     | YES         | null                       | null                     | null              | null          |
| trades                        | image_urls              | ARRAY                    | YES         | null                       | null                     | null              | null          |
| trades                        | tags                    | ARRAY                    | YES         | null                       | null                     | null              | null          |
| trades                        | created_at              | timestamp with time zone | YES         | now()                      | null                     | null              | null          |
| trades                        | updated_at              | timestamp with time zone | YES         | now()                      | null                     | null              | null          |
| trades                        | entry_time              | timestamp with time zone | YES         | null                       | null                     | null              | null          |
| trades                        | duration                | integer                  | YES         | null                       | null                     | 32                | 0             |
| trades                        | pips                    | numeric                  | YES         | null                       | null                     | 10                | 2             |
| trades                        | currency                | text                     | NO          | 'AUD'::text                | null                     | null              | null          |
| user_presence                 | id                      | uuid                     | NO          | uuid_generate_v4()         | null                     | null              | null          |
| user_presence                 | user_id                 | uuid                     | YES         | null                       | null                     | null              | null          |
| user_presence                 | status                  | USER-DEFINED             | YES         | 'OFFLINE'::presence_status | null                     | null              | null          |
| user_presence                 | last_seen_at            | timestamp with time zone | YES         | now()                      | null                     | null              | null          |
| user_presence                 | created_at              | timestamp with time zone | YES         | now()                      | null                     | null              | null          |
| user_presence                 | updated_at              | timestamp with time zone | YES         | now()                      | null                     | null              | null          |
| user_settings                 | id                      | uuid                     | NO          | uuid_generate_v4()         | null                     | null              | null          |
| user_settings                 | user_id                 | uuid                     | YES         | null                       | null                     | null              | null          |
| user_settings                 | theme                   | text                     | YES         | 'light'::text              | null                     | null              | null          |
| user_settings                 | notifications_enabled   | boolean                  | YES         | true                       | null                     | null              | null          |
| user_settings                 | email_notifications     | boolean                  | YES         | true                       | null                     | null              | null          |
| user_settings                 | default_currency        | text                     | YES         | 'USD'::text                | null                     | null              | null          |
| user_settings                 | timezone                | text                     | YES         | 'UTC'::text                | null                     | null              | null          |
| user_settings                 | created_at              | timestamp with time zone | YES         | now()                      | null                     | null              | null          |
| user_settings                 | updated_at              | timestamp with time zone | YES         | now()                      | null                     | null              | null          |
| user_settings                 | pips_or_percentage      | text                     | YES         | 'currency'::text           | null                     | null              | null          |
| user_settings                 | chart_timeframe         | text                     | YES         | 'daily'::text              | null                     | null              | null          |
| user_settings                 | share_statistics        | boolean                  | YES         | false                      | null                     | null              | null          |
| user_settings                 | public_profile          | boolean                  | YES         | false                      | null                     | null              | null          |
| user_settings                 | weekly_reports          | boolean                  | YES         | false                      | null                     | null              | null          |
| user_settings                 | monthly_reports         | boolean                  | YES         | false                      | null                     | null              | null          |
| user_settings                 | quarterly_reports       | boolean                  | YES         | false                      | null                     | null              | null          |
| user_settings                 | yearly_reports          | boolean                  | YES         | false                      | null                     | null              | null          |
| user_settings                 | ai_api_key              | text                     | YES         | null                       | null                     | null              | null          |
| user_settings                 | monthly_trade_checkup   | boolean                  | YES         | false                      | null                     | null              | null          |
| user_settings                 | email_project_updates   | boolean                  | NO          | false                      | null                     | null              | null          |
| user_settings                 | recent_trades_count     | integer                  | YES         | 5                          | null                     | 32                | 0             |
| user_settings                 | email_friend_requests   | boolean                  | YES         | false                      | null                     | null              | null          |
| user_settings                 | email_trade_shared      | boolean                  | YES         | false                      | null                     | null              | null          |
| user_settings                 | email_medal_achievement | boolean                  | YES         | false                      | null                     | null              | null          |
| user_settings                 | push_friend_requests    | boolean                  | YES         | false                      | null                     | null              | null          |
| user_settings                 | push_trade_shared       | boolean                  | YES         | false                      | null                     | null              | null          |
| user_settings                 | push_medal_achievement  | boolean                  | YES         | false                      | null                     | null              | null          |
| user_settings                 | performance_view        | text                     | YES         | 'total'::text              | null                     | null              | null          |

6. Storage buckets



7. SUPABASE all RLS policies

| schemaname | tablename                     | policyname                                  | permissive | roles           | cmd    | qual                                                                                                                                                                                                                                   | with_check                                                                                                                                                                                                                                                          |
| ---------- | ----------------------------- | ------------------------------------------- | ---------- | --------------- | ------ | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| public     | audit_logs                    | No one can delete audit logs                | PERMISSIVE | {public}        | DELETE | false                                                                                                                                                                                                                                  | null                                                                                                                                                                                                                                                                |
| public     | audit_logs                    | No one can update audit logs                | PERMISSIVE | {public}        | UPDATE | false                                                                                                                                                                                                                                  | null                                                                                                                                                                                                                                                                |
| public     | audit_logs                    | Staff can view audit logs                   | PERMISSIVE | {public}        | SELECT | (EXISTS ( SELECT 1
   FROM profiles
  WHERE ((profiles.id = auth.uid()) AND (profiles.role = 'ADMIN'::user_role))))                                                                                                                    | null                                                                                                                                                                                                                                                                |
| public     | audit_logs                    | System can insert audit logs                | PERMISSIVE | {public}        | INSERT | null                                                                                                                                                                                                                                   | true                                                                                                                                                                                                                                                                |
| public     | chat_group_invitations        | Users can view invitations sent to them     | PERMISSIVE | {public}        | SELECT | (auth.uid() = invitee_id)                                                                                                                                                                                                              | null                                                                                                                                                                                                                                                                |
| public     | chat_group_invitations        | member_invitation_access                    | PERMISSIVE | {authenticated} | SELECT | (group_id IN ( SELECT chat_group_members.group_id
   FROM chat_group_members
  WHERE (chat_group_members.user_id = auth.uid())))                                                                                                       | null                                                                                                                                                                                                                                                                |
| public     | chat_group_invitations        | user_invitations_only                       | PERMISSIVE | {authenticated} | ALL    | ((invitee_id = auth.uid()) OR (inviter_id = auth.uid()))                                                                                                                                                                               | (inviter_id = auth.uid())                                                                                                                                                                                                                                           |
| public     | chat_group_members            | Group creators can add members              | PERMISSIVE | {public}        | INSERT | null                                                                                                                                                                                                                                   | (EXISTS ( SELECT 1
   FROM chat_groups
  WHERE ((chat_groups.id = chat_group_members.group_id) AND (chat_groups.creator_id = auth.uid()))))                                                                                                                         |
| public     | chat_group_members            | Group members can view group members        | PERMISSIVE | {public}        | SELECT | (EXISTS ( SELECT 1
   FROM chat_group_members chat_group_members_1
  WHERE ((chat_group_members_1.group_id = chat_group_members_1.group_id) AND (chat_group_members_1.user_id = auth.uid()))))                                         | null                                                                                                                                                                                                                                                                |
| public     | chat_group_members            | user_memberships_only                       | PERMISSIVE | {authenticated} | ALL    | (user_id = auth.uid())                                                                                                                                                                                                                 | (user_id = auth.uid())                                                                                                                                                                                                                                              |
| public     | chat_groups                   | Users can create groups                     | PERMISSIVE | {public}        | INSERT | null                                                                                                                                                                                                                                   | (auth.uid() = creator_id)                                                                                                                                                                                                                                           |
| public     | chat_groups                   | Users can view groups they are members of   | PERMISSIVE | {public}        | SELECT | (EXISTS ( SELECT 1
   FROM chat_group_members
  WHERE ((chat_group_members.group_id = chat_groups.id) AND (chat_group_members.user_id = auth.uid()))))                                                                                 | null                                                                                                                                                                                                                                                                |
| public     | chat_groups                   | member_group_access                         | PERMISSIVE | {authenticated} | SELECT | (id IN ( SELECT chat_group_members.group_id
   FROM chat_group_members
  WHERE (chat_group_members.user_id = auth.uid())))                                                                                                             | null                                                                                                                                                                                                                                                                |
| public     | chat_groups                   | user_groups_only                            | PERMISSIVE | {authenticated} | ALL    | (creator_id = auth.uid())                                                                                                                                                                                                              | (creator_id = auth.uid())                                                                                                                                                                                                                                           |
| public     | chat_messages                 | member_message_access                       | PERMISSIVE | {authenticated} | SELECT | (group_id IN ( SELECT chat_group_members.group_id
   FROM chat_group_members
  WHERE (chat_group_members.user_id = auth.uid())))                                                                                                       | null                                                                                                                                                                                                                                                                |
| public     | chat_messages                 | user_messages_only                          | PERMISSIVE | {authenticated} | ALL    | (sender_id = auth.uid())                                                                                                                                                                                                               | (sender_id = auth.uid())                                                                                                                                                                                                                                            |
| public     | friend_requests               | Users can manage their friend requests      | PERMISSIVE | {public}        | ALL    | ((auth.uid() = sender_id) OR (auth.uid() = recipient_id))                                                                                                                                                                              | null                                                                                                                                                                                                                                                                |
| public     | messages                      | messages_delete_policy                      | PERMISSIVE | {authenticated} | DELETE | ((sender_id = auth.uid()) OR (receiver_id = auth.uid()))                                                                                                                                                                               | null                                                                                                                                                                                                                                                                |
| public     | messages                      | messages_insert_policy                      | PERMISSIVE | {authenticated} | INSERT | null                                                                                                                                                                                                                                   | (auth.uid() = sender_id)                                                                                                                                                                                                                                            |
| public     | messages                      | messages_select_policy                      | PERMISSIVE | {authenticated} | SELECT | ((sender_id = auth.uid()) OR (receiver_id = auth.uid()))                                                                                                                                                                               | null                                                                                                                                                                                                                                                                |
| public     | messages                      | messages_update_policy                      | PERMISSIVE | {authenticated} | UPDATE | (auth.uid() = sender_id)                                                                                                                                                                                                               | (auth.uid() = sender_id)                                                                                                                                                                                                                                            |
| public     | profiles                      | profiles_delete_policy                      | PERMISSIVE | {authenticated} | DELETE | (auth.uid() = id)                                                                                                                                                                                                                      | null                                                                                                                                                                                                                                                                |
| public     | profiles                      | profiles_insert_policy                      | PERMISSIVE | {authenticated} | INSERT | null                                                                                                                                                                                                                                   | (auth.uid() = id)                                                                                                                                                                                                                                                   |
| public     | profiles                      | profiles_select_policy                      | PERMISSIVE | {authenticated} | SELECT | true                                                                                                                                                                                                                                   | null                                                                                                                                                                                                                                                                |
| public     | profiles                      | profiles_update_policy                      | PERMISSIVE | {authenticated} | UPDATE | (auth.uid() = id)                                                                                                                                                                                                                      | (auth.uid() = id)                                                                                                                                                                                                                                                   |
| public     | shared_trade_comments         | Users can comment on shared trades          | PERMISSIVE | {public}        | INSERT | null                                                                                                                                                                                                                                   | ((auth.uid() = user_id) AND (EXISTS ( SELECT 1
   FROM shared_trades st
  WHERE ((st.id = shared_trade_comments.shared_trade_id) AND (((st.share_type)::text = 'public'::text) OR (st.shared_with_user_id = auth.uid()) OR (st.shared_by_user_id = auth.uid())))))) |
| public     | shared_trade_comments         | Users can delete their own comments         | PERMISSIVE | {public}        | DELETE | (user_id = auth.uid())                                                                                                                                                                                                                 | null                                                                                                                                                                                                                                                                |
| public     | shared_trade_comments         | Users can update their own comments         | PERMISSIVE | {public}        | UPDATE | (user_id = auth.uid())                                                                                                                                                                                                                 | null                                                                                                                                                                                                                                                                |
| public     | shared_trade_comments         | Users can view shared trade comments        | PERMISSIVE | {public}        | SELECT | (EXISTS ( SELECT 1
   FROM shared_trades st
  WHERE ((st.id = shared_trade_comments.shared_trade_id) AND (((st.share_type)::text = 'public'::text) OR (st.shared_with_user_id = auth.uid()) OR (st.shared_by_user_id = auth.uid()))))) | null                                                                                                                                                                                                                                                                |
| public     | shared_trade_likes            | Users can like shared trades                | PERMISSIVE | {public}        | INSERT | null                                                                                                                                                                                                                                   | ((auth.uid() = user_id) AND (EXISTS ( SELECT 1
   FROM shared_trades st
  WHERE ((st.id = shared_trade_likes.shared_trade_id) AND (((st.share_type)::text = 'public'::text) OR (st.shared_with_user_id = auth.uid()) OR (st.shared_by_user_id = auth.uid()))))))    |
| public     | shared_trade_likes            | Users can unlike their own likes            | PERMISSIVE | {public}        | DELETE | (user_id = auth.uid())                                                                                                                                                                                                                 | null                                                                                                                                                                                                                                                                |
| public     | shared_trade_likes            | Users can view shared trade likes           | PERMISSIVE | {public}        | SELECT | (EXISTS ( SELECT 1
   FROM shared_trades st
  WHERE ((st.id = shared_trade_likes.shared_trade_id) AND (((st.share_type)::text = 'public'::text) OR (st.shared_with_user_id = auth.uid()) OR (st.shared_by_user_id = auth.uid())))))    | null                                                                                                                                                                                                                                                                |
| public     | shared_trades                 | Users can create shared trades              | PERMISSIVE | {public}        | INSERT | null                                                                                                                                                                                                                                   | ((shared_by_user_id = auth.uid()) AND (EXISTS ( SELECT 1
   FROM trades
  WHERE ((trades.id = shared_trades.original_trade_id) AND (trades.user_id = auth.uid())))))                                                                                                |
| public     | shared_trades                 | Users can delete their own shared trades    | PERMISSIVE | {public}        | DELETE | (shared_by_user_id = auth.uid())                                                                                                                                                                                                       | null                                                                                                                                                                                                                                                                |
| public     | shared_trades                 | Users can update their own shared trades    | PERMISSIVE | {public}        | UPDATE | (shared_by_user_id = auth.uid())                                                                                                                                                                                                       | null                                                                                                                                                                                                                                                                |
| public     | shared_trades                 | Users can view shared trades                | PERMISSIVE | {public}        | SELECT | (((share_type)::text = 'public'::text) OR (shared_with_user_id = auth.uid()) OR (shared_by_user_id = auth.uid()))                                                                                                                      | null                                                                                                                                                                                                                                                                |
| public     | support_replies               | Admins can reply to requests                | PERMISSIVE | {public}        | INSERT | null                                                                                                                                                                                                                                   | ((admin_id = auth.uid()) AND (EXISTS ( SELECT 1
   FROM profiles
  WHERE ((profiles.id = auth.uid()) AND (profiles.role = 'ADMIN'::user_role)))))                                                                                                                   |
| public     | support_replies               | Admins can see all replies                  | PERMISSIVE | {public}        | SELECT | (EXISTS ( SELECT 1
   FROM profiles
  WHERE ((profiles.id = auth.uid()) AND (profiles.role = 'ADMIN'::user_role))))                                                                                                                    | null                                                                                                                                                                                                                                                                |
| public     | support_replies               | Admins can update own replies               | PERMISSIVE | {public}        | UPDATE | ((admin_id = auth.uid()) AND (EXISTS ( SELECT 1
   FROM profiles
  WHERE ((profiles.id = auth.uid()) AND (profiles.role = 'ADMIN'::user_role)))))                                                                                      | null                                                                                                                                                                                                                                                                |
| public     | support_replies               | No deletion of support replies              | PERMISSIVE | {public}        | DELETE | false                                                                                                                                                                                                                                  | null                                                                                                                                                                                                                                                                |
| public     | support_replies               | Users can see replies to own requests       | PERMISSIVE | {public}        | SELECT | (EXISTS ( SELECT 1
   FROM support_requests
  WHERE ((support_requests.id = support_replies.support_request_id) AND (support_requests.user_id = auth.uid()))))                                                                         | null                                                                                                                                                                                                                                                                |
| public     | support_requests              | Admins can update any support request       | PERMISSIVE | {public}        | UPDATE | (EXISTS ( SELECT 1
   FROM profiles
  WHERE ((profiles.id = auth.uid()) AND (profiles.role = 'ADMIN'::user_role))))                                                                                                                    | null                                                                                                                                                                                                                                                                |
| public     | support_requests              | Admins can view all support requests        | PERMISSIVE | {public}        | SELECT | (EXISTS ( SELECT 1
   FROM profiles
  WHERE ((profiles.id = auth.uid()) AND (profiles.role = 'ADMIN'::user_role))))                                                                                                                    | null                                                                                                                                                                                                                                                                |
| public     | support_requests              | Users can create support requests           | PERMISSIVE | {public}        | INSERT | null                                                                                                                                                                                                                                   | (user_id = auth.uid())                                                                                                                                                                                                                                              |
| public     | support_requests              | Users can update own open requests          | PERMISSIVE | {public}        | UPDATE | ((user_id = auth.uid()) AND (status <> 'CLOSED'::text))                                                                                                                                                                                | null                                                                                                                                                                                                                                                                |
| public     | support_requests              | Users can view own support requests         | PERMISSIVE | {public}        | SELECT | (user_id = auth.uid())                                                                                                                                                                                                                 | null                                                                                                                                                                                                                                                                |
| public     | support_requests              | Users cannot delete support requests        | PERMISSIVE | {public}        | DELETE | false                                                                                                                                                                                                                                  | null                                                                                                                                                                                                                                                                |
| public     | tda_analysis_history          | System can insert analysis history          | PERMISSIVE | {public}        | INSERT | null                                                                                                                                                                                                                                   | true                                                                                                                                                                                                                                                                |
| public     | tda_analysis_history          | Users can view their analysis history       | PERMISSIVE | {public}        | SELECT | (EXISTS ( SELECT 1
   FROM top_down_analyses
  WHERE ((top_down_analyses.id = tda_analysis_history.analysis_id) AND (top_down_analyses.user_id = auth.uid()))))                                                                        | null                                                                                                                                                                                                                                                                |
| public     | tda_announcements             | Users can delete their announcements        | PERMISSIVE | {public}        | DELETE | (EXISTS ( SELECT 1
   FROM top_down_analyses
  WHERE ((top_down_analyses.id = tda_announcements.analysis_id) AND (top_down_analyses.user_id = auth.uid()))))                                                                           | null                                                                                                                                                                                                                                                                |
| public     | tda_announcements             | Users can insert their announcements        | PERMISSIVE | {public}        | INSERT | null                                                                                                                                                                                                                                   | (EXISTS ( SELECT 1
   FROM top_down_analyses
  WHERE ((top_down_analyses.id = tda_announcements.analysis_id) AND (top_down_analyses.user_id = auth.uid()))))                                                                                                        |
| public     | tda_announcements             | Users can update their announcements        | PERMISSIVE | {public}        | UPDATE | (EXISTS ( SELECT 1
   FROM top_down_analyses
  WHERE ((top_down_analyses.id = tda_announcements.analysis_id) AND (top_down_analyses.user_id = auth.uid()))))                                                                           | null                                                                                                                                                                                                                                                                |
| public     | tda_announcements             | Users can view their announcements          | PERMISSIVE | {public}        | SELECT | (EXISTS ( SELECT 1
   FROM top_down_analyses
  WHERE ((top_down_analyses.id = tda_announcements.analysis_id) AND (top_down_analyses.user_id = auth.uid()))))                                                                           | null                                                                                                                                                                                                                                                                |
| public     | tda_answers                   | Users can delete their answers              | PERMISSIVE | {public}        | DELETE | (EXISTS ( SELECT 1
   FROM top_down_analyses
  WHERE ((top_down_analyses.id = tda_answers.analysis_id) AND (top_down_analyses.user_id = auth.uid()))))                                                                                 | null                                                                                                                                                                                                                                                                |
| public     | tda_answers                   | Users can insert their answers              | PERMISSIVE | {public}        | INSERT | null                                                                                                                                                                                                                                   | (EXISTS ( SELECT 1
   FROM top_down_analyses
  WHERE ((top_down_analyses.id = tda_answers.analysis_id) AND (top_down_analyses.user_id = auth.uid()))))                                                                                                              |
| public     | tda_answers                   | Users can update their answers              | PERMISSIVE | {public}        | UPDATE | (EXISTS ( SELECT 1
   FROM top_down_analyses
  WHERE ((top_down_analyses.id = tda_answers.analysis_id) AND (top_down_analyses.user_id = auth.uid()))))                                                                                 | null                                                                                                                                                                                                                                                                |
| public     | tda_answers                   | Users can view their answers                | PERMISSIVE | {public}        | SELECT | (EXISTS ( SELECT 1
   FROM top_down_analyses
  WHERE ((top_down_analyses.id = tda_answers.analysis_id) AND (top_down_analyses.user_id = auth.uid()))))                                                                                 | null                                                                                                                                                                                                                                                                |
| public     | tda_questions                 | Authenticated users can view questions      | PERMISSIVE | {public}        | SELECT | (auth.role() = 'authenticated'::text)                                                                                                                                                                                                  | null                                                                                                                                                                                                                                                                |
| public     | tda_screenshots               | Users can delete their screenshots          | PERMISSIVE | {public}        | DELETE | (EXISTS ( SELECT 1
   FROM top_down_analyses
  WHERE ((top_down_analyses.id = tda_screenshots.analysis_id) AND (top_down_analyses.user_id = auth.uid()))))                                                                             | null                                                                                                                                                                                                                                                                |
| public     | tda_screenshots               | Users can insert their screenshots          | PERMISSIVE | {public}        | INSERT | null                                                                                                                                                                                                                                   | (EXISTS ( SELECT 1
   FROM top_down_analyses
  WHERE ((top_down_analyses.id = tda_screenshots.analysis_id) AND (top_down_analyses.user_id = auth.uid()))))                                                                                                          |
| public     | tda_screenshots               | Users can update their screenshots          | PERMISSIVE | {public}        | UPDATE | (EXISTS ( SELECT 1
   FROM top_down_analyses
  WHERE ((top_down_analyses.id = tda_screenshots.analysis_id) AND (top_down_analyses.user_id = auth.uid()))))                                                                             | null                                                                                                                                                                                                                                                                |
| public     | tda_screenshots               | Users can view their screenshots            | PERMISSIVE | {public}        | SELECT | (EXISTS ( SELECT 1
   FROM top_down_analyses
  WHERE ((top_down_analyses.id = tda_screenshots.analysis_id) AND (top_down_analyses.user_id = auth.uid()))))                                                                             | null                                                                                                                                                                                                                                                                |
| public     | tda_timeframe_analyses        | Users can delete their timeframe analyses   | PERMISSIVE | {public}        | DELETE | (EXISTS ( SELECT 1
   FROM top_down_analyses
  WHERE ((top_down_analyses.id = tda_timeframe_analyses.analysis_id) AND (top_down_analyses.user_id = auth.uid()))))                                                                      | null                                                                                                                                                                                                                                                                |
| public     | tda_timeframe_analyses        | Users can insert their timeframe analyses   | PERMISSIVE | {public}        | INSERT | null                                                                                                                                                                                                                                   | (EXISTS ( SELECT 1
   FROM top_down_analyses
  WHERE ((top_down_analyses.id = tda_timeframe_analyses.analysis_id) AND (top_down_analyses.user_id = auth.uid()))))                                                                                                   |
| public     | tda_timeframe_analyses        | Users can update their timeframe analyses   | PERMISSIVE | {public}        | UPDATE | (EXISTS ( SELECT 1
   FROM top_down_analyses
  WHERE ((top_down_analyses.id = tda_timeframe_analyses.analysis_id) AND (top_down_analyses.user_id = auth.uid()))))                                                                      | null                                                                                                                                                                                                                                                                |
| public     | tda_timeframe_analyses        | Users can view their timeframe analyses     | PERMISSIVE | {public}        | SELECT | (EXISTS ( SELECT 1
   FROM top_down_analyses
  WHERE ((top_down_analyses.id = tda_timeframe_analyses.analysis_id) AND (top_down_analyses.user_id = auth.uid()))))                                                                      | null                                                                                                                                                                                                                                                                |
| public     | top_down_analyses             | Users can delete their own analyses         | PERMISSIVE | {public}        | DELETE | (auth.uid() = user_id)                                                                                                                                                                                                                 | null                                                                                                                                                                                                                                                                |
| public     | top_down_analyses             | Users can insert their own analyses         | PERMISSIVE | {public}        | INSERT | null                                                                                                                                                                                                                                   | (auth.uid() = user_id)                                                                                                                                                                                                                                              |
| public     | top_down_analyses             | Users can update their own analyses         | PERMISSIVE | {public}        | UPDATE | (auth.uid() = user_id)                                                                                                                                                                                                                 | null                                                                                                                                                                                                                                                                |
| public     | top_down_analyses             | Users can view their own analyses           | PERMISSIVE | {public}        | SELECT | (auth.uid() = user_id)                                                                                                                                                                                                                 | null                                                                                                                                                                                                                                                                |
| public     | trade_setup_comment_reactions | Users can add comment reactions             | PERMISSIVE | {public}        | INSERT | null                                                                                                                                                                                                                                   | ((user_id = auth.uid()) AND (EXISTS ( SELECT 1
   FROM (trade_setup_comments c
     JOIN trade_setups ts ON ((c.trade_setup_id = ts.id)))
  WHERE ((c.id = trade_setup_comment_reactions.comment_id) AND (ts.is_public OR (ts.user_id = auth.uid()))))))            |
| public     | trade_setup_comment_reactions | Users can delete their own reactions        | PERMISSIVE | {public}        | DELETE | (user_id = auth.uid())                                                                                                                                                                                                                 | null                                                                                                                                                                                                                                                                |
| public     | trade_setup_comment_reactions | Users can update their own reactions        | PERMISSIVE | {public}        | UPDATE | (user_id = auth.uid())                                                                                                                                                                                                                 | null                                                                                                                                                                                                                                                                |
| public     | trade_setup_comment_reactions | Users can view comment reactions            | PERMISSIVE | {public}        | SELECT | (EXISTS ( SELECT 1
   FROM (trade_setup_comments c
     JOIN trade_setups ts ON ((c.trade_setup_id = ts.id)))
  WHERE ((c.id = trade_setup_comment_reactions.comment_id) AND (ts.is_public OR (ts.user_id = auth.uid())))))            | null                                                                                                                                                                                                                                                                |
| public     | trade_setup_comments          | Allow authenticated insert                  | PERMISSIVE | {public}        | INSERT | null                                                                                                                                                                                                                                   | (auth.uid() IS NOT NULL)                                                                                                                                                                                                                                            |
| public     | trade_setup_comments          | Comments visibility                         | PERMISSIVE | {public}        | SELECT | (EXISTS ( SELECT 1
   FROM trade_setups
  WHERE ((trade_setups.id = trade_setup_comments.trade_setup_id) AND (trade_setups.is_public OR (trade_setups.user_id = auth.uid())))))                                                        | null                                                                                                                                                                                                                                                                |
| public     | trade_setup_comments          | Users can add comments                      | PERMISSIVE | {public}        | INSERT | null                                                                                                                                                                                                                                   | (user_id = auth.uid())                                                                                                                                                                                                                                              |
| public     | trade_setup_comments          | Users can delete own comments               | PERMISSIVE | {public}        | DELETE | (user_id = auth.uid())                                                                                                                                                                                                                 | null                                                                                                                                                                                                                                                                |
| public     | trade_setup_comments          | Users can delete own trade setup comments   | PERMISSIVE | {authenticated} | DELETE | (auth.uid() = user_id)                                                                                                                                                                                                                 | null                                                                                                                                                                                                                                                                |
| public     | trade_setup_comments          | Users can insert own trade setup comments   | PERMISSIVE | {authenticated} | INSERT | null                                                                                                                                                                                                                                   | (auth.uid() = user_id)                                                                                                                                                                                                                                              |
| public     | trade_setup_comments          | Users can update own comments               | PERMISSIVE | {public}        | UPDATE | (user_id = auth.uid())                                                                                                                                                                                                                 | null                                                                                                                                                                                                                                                                |
| public     | trade_setup_comments          | Users can update own trade setup comments   | PERMISSIVE | {authenticated} | UPDATE | (auth.uid() = user_id)                                                                                                                                                                                                                 | null                                                                                                                                                                                                                                                                |
| public     | trade_setup_comments          | Users can view all trade setup comments     | PERMISSIVE | {authenticated} | SELECT | true                                                                                                                                                                                                                                   | null                                                                                                                                                                                                                                                                |
| public     | trade_setup_dislikes          | Dislikes visibility                         | PERMISSIVE | {public}        | SELECT | (EXISTS ( SELECT 1
   FROM trade_setups
  WHERE ((trade_setups.id = trade_setup_dislikes.trade_setup_id) AND (trade_setups.is_public OR (trade_setups.user_id = auth.uid())))))                                                        | null                                                                                                                                                                                                                                                                |
| public     | trade_setup_dislikes          | Users can dislike trade setups              | PERMISSIVE | {public}        | INSERT | null                                                                                                                                                                                                                                   | (user_id = auth.uid())                                                                                                                                                                                                                                              |
| public     | trade_setup_dislikes          | Users can remove own dislikes               | PERMISSIVE | {public}        | DELETE | (user_id = auth.uid())                                                                                                                                                                                                                 | null                                                                                                                                                                                                                                                                |
| public     | trade_setup_dislikes          | Users cannot update dislikes                | PERMISSIVE | {public}        | UPDATE | false                                                                                                                                                                                                                                  | null                                                                                                                                                                                                                                                                |
| public     | trade_setup_likes             | Likes visibility                            | PERMISSIVE | {public}        | SELECT | (EXISTS ( SELECT 1
   FROM trade_setups
  WHERE ((trade_setups.id = trade_setup_likes.trade_setup_id) AND (trade_setups.is_public OR (trade_setups.user_id = auth.uid())))))                                                           | null                                                                                                                                                                                                                                                                |
| public     | trade_setup_likes             | Users can delete own trade setup likes      | PERMISSIVE | {authenticated} | DELETE | (auth.uid() = user_id)                                                                                                                                                                                                                 | null                                                                                                                                                                                                                                                                |
| public     | trade_setup_likes             | Users can insert own trade setup likes      | PERMISSIVE | {authenticated} | INSERT | null                                                                                                                                                                                                                                   | (auth.uid() = user_id)                                                                                                                                                                                                                                              |
| public     | trade_setup_likes             | Users can like trade setups                 | PERMISSIVE | {public}        | INSERT | null                                                                                                                                                                                                                                   | (user_id = auth.uid())                                                                                                                                                                                                                                              |
| public     | trade_setup_likes             | Users can remove own likes                  | PERMISSIVE | {public}        | DELETE | (user_id = auth.uid())                                                                                                                                                                                                                 | null                                                                                                                                                                                                                                                                |
| public     | trade_setup_likes             | Users can view all trade setup likes        | PERMISSIVE | {authenticated} | SELECT | true                                                                                                                                                                                                                                   | null                                                                                                                                                                                                                                                                |
| public     | trade_setup_likes             | Users cannot update likes                   | PERMISSIVE | {public}        | UPDATE | false                                                                                                                                                                                                                                  | null                                                                                                                                                                                                                                                                |
| public     | trade_setup_tags              | Users can manage their own trade setup tags | PERMISSIVE | {public}        | ALL    | (EXISTS ( SELECT 1
   FROM trade_setups
  WHERE ((trade_setups.id = trade_setup_tags.setup_id) AND (trade_setups.user_id = auth.uid()))))                                                                                              | null                                                                                                                                                                                                                                                                |
| public     | trade_setups                  | trade_setups_delete_policy                  | PERMISSIVE | {authenticated} | DELETE | (user_id = auth.uid())                                                                                                                                                                                                                 | null                                                                                                                                                                                                                                                                |
| public     | trade_setups                  | trade_setups_insert_policy                  | PERMISSIVE | {authenticated} | INSERT | null                                                                                                                                                                                                                                   | (auth.uid() = user_id)                                                                                                                                                                                                                                              |
| public     | trade_setups                  | trade_setups_select_policy                  | PERMISSIVE | {authenticated} | SELECT | (is_public OR (user_id = auth.uid()))                                                                                                                                                                                                  | null                                                                                                                                                                                                                                                                |
| public     | trade_setups                  | trade_setups_update_policy                  | PERMISSIVE | {authenticated} | UPDATE | (auth.uid() = user_id)                                                                                                                                                                                                                 | (auth.uid() = user_id)                                                                                                                                                                                                                                              |
| public     | trader_friends                | Friend visibility                           | PERMISSIVE | {public}        | SELECT | ((user1_id = auth.uid()) OR (user2_id = auth.uid()))                                                                                                                                                                                   | null                                                                                                                                                                                                                                                                |
| public     | trader_friends                | Users can create friend requests            | PERMISSIVE | {public}        | INSERT | null                                                                                                                                                                                                                                   | (user1_id = auth.uid())                                                                                                                                                                                                                                             |
| public     | trader_friends                | Users can end friendships                   | PERMISSIVE | {public}        | DELETE | ((user1_id = auth.uid()) OR (user2_id = auth.uid()))                                                                                                                                                                                   | null                                                                                                                                                                                                                                                                |
| public     | trader_friends                | Users can update friendship status          | PERMISSIVE | {public}        | UPDATE | ((user1_id = auth.uid()) OR (user2_id = auth.uid()))                                                                                                                                                                                   | null                                                                                                                                                                                                                                                                |
| public     | trades                        | Allow users to delete their own trades      | PERMISSIVE | {authenticated} | DELETE | (auth.uid() = user_id)                                                                                                                                                                                                                 | null                                                                                                                                                                                                                                                                |
| public     | trades                        | trades_insert_policy                        | PERMISSIVE | {authenticated} | INSERT | null                                                                                                                                                                                                                                   | (auth.uid() = user_id)                                                                                                                                                                                                                                              |
| public     | trades                        | trades_select_policy                        | PERMISSIVE | {authenticated} | SELECT | (auth.uid() = user_id)                                                                                                                                                                                                                 | null                                                                                                                                                                                                                                                                |
| public     | trades                        | trades_update_policy                        | PERMISSIVE | {authenticated} | UPDATE | (auth.uid() = user_id)                                                                                                                                                                                                                 | (auth.uid() = user_id)                                                                                                                                                                                                                                              |
| public     | user_presence                 | user_presence_delete_policy                 | PERMISSIVE | {authenticated} | DELETE | (auth.uid() = user_id)                                                                                                                                                                                                                 | null                                                                                                                                                                                                                                                                |
| public     | user_presence                 | user_presence_insert_policy                 | PERMISSIVE | {authenticated} | INSERT | null                                                                                                                                                                                                                                   | (auth.uid() = user_id)                                                                                                                                                                                                                                              |
| public     | user_presence                 | user_presence_select_policy                 | PERMISSIVE | {authenticated} | SELECT | true                                                                                                                                                                                                                                   | null                                                                                                                                                                                                                                                                |
| public     | user_presence                 | user_presence_update_policy                 | PERMISSIVE | {authenticated} | UPDATE | (auth.uid() = user_id)                                                                                                                                                                                                                 | (auth.uid() = user_id)                                                                                                                                                                                                                                              |
| public     | user_settings                 | Users can read monthly_trade_checkup        | PERMISSIVE | {public}        | SELECT | (auth.uid() = user_id)                                                                                                                                                                                                                 | null                                                                                                                                                                                                                                                                |
| public     | user_settings                 | Users can update monthly_trade_checkup      | PERMISSIVE | {public}        | UPDATE | (auth.uid() = user_id)                                                                                                                                                                                                                 | (auth.uid() = user_id)                                                                                                                                                                                                                                              |
| public     | user_settings                 | user_settings_delete                        | PERMISSIVE | {public}        | DELETE | (auth.uid() = user_id)                                                                                                                                                                                                                 | null                                                                                                                                                                                                                                                                |
| public     | user_settings                 | user_settings_delete_policy                 | PERMISSIVE | {public}        | DELETE | (auth.uid() = user_id)                                                                                                                                                                                                                 | null                                                                                                                                                                                                                                                                |
| public     | user_settings                 | user_settings_insert                        | PERMISSIVE | {public}        | INSERT | null                                                                                                                                                                                                                                   | (auth.uid() = user_id)                                                                                                                                                                                                                                              |
| public     | user_settings                 | user_settings_insert_policy                 | PERMISSIVE | {public}        | INSERT | null                                                                                                                                                                                                                                   | (auth.uid() = user_id)                                                                                                                                                                                                                                              |
| public     | user_settings                 | user_settings_select                        | PERMISSIVE | {public}        | SELECT | (auth.uid() = user_id)                                                                                                                                                                                                                 | null                                                                                                                                                                                                                                                                |
| public     | user_settings                 | user_settings_select_policy                 | PERMISSIVE | {public}        | SELECT | (auth.uid() = user_id)                                                                                                                                                                                                                 | null                                                                                                                                                                                                                                                                |
| public     | user_settings                 | user_settings_update                        | PERMISSIVE | {public}        | UPDATE | (auth.uid() = user_id)                                                                                                                                                                                                                 | null                                                                                                                                                                                                                                                                |
| public     | user_settings                 | user_settings_update_policy                 | PERMISSIVE | {public}        | UPDATE | (auth.uid() = user_id)                                                                                                                                                                                                                 | null                                                                                                                                                                                                                                                                |

8. SUPABASE all foreign key relationships

| table_name                    | column_name        | foreign_table_name    | foreign_column_name | constraint_name                               |
| ----------------------------- | ------------------ | --------------------- | ------------------- | --------------------------------------------- |
| chat_group_invitations        | group_id           | chat_groups           | id                  | chat_group_invitations_group_id_fkey          |
| chat_group_invitations        | invitee_id         | profiles              | id                  | chat_group_invitations_invitee_id_fkey        |
| chat_group_invitations        | inviter_id         | profiles              | id                  | chat_group_invitations_inviter_id_fkey        |
| chat_group_members            | group_id           | chat_groups           | id                  | chat_group_members_group_id_fkey              |
| chat_group_members            | user_id            | profiles              | id                  | chat_group_members_user_id_fkey               |
| chat_groups                   | creator_id         | profiles              | id                  | chat_groups_creator_id_fkey                   |
| chat_messages                 | group_id           | chat_groups           | id                  | chat_messages_group_id_fkey                   |
| chat_messages                 | sender_id          | profiles              | id                  | chat_messages_sender_id_fkey                  |
| friend_requests               | recipient_id       | profiles              | id                  | friend_requests_recipient_id_fkey             |
| friend_requests               | sender_id          | profiles              | id                  | friend_requests_sender_id_fkey                |
| messages                      | receiver_id        | profiles              | id                  | messages_receiver_id_fkey                     |
| messages                      | sender_id          | profiles              | id                  | messages_sender_id_fkey                       |
| shared_trade_comments         | parent_id          | shared_trade_comments | id                  | shared_trade_comments_parent_id_fkey          |
| shared_trade_comments         | shared_trade_id    | shared_trades         | id                  | shared_trade_comments_shared_trade_id_fkey    |
| shared_trade_likes            | shared_trade_id    | shared_trades         | id                  | shared_trade_likes_shared_trade_id_fkey       |
| shared_trades                 | original_trade_id  | trades                | id                  | shared_trades_original_trade_id_fkey          |
| shared_trades                 | recipient_id       | profiles              | id                  | shared_trades_recipient_id_fkey               |
| shared_trades                 | sharer_id          | profiles              | id                  | shared_trades_sharer_id_fkey                  |
| shared_trades                 | trade_id           | trades                | id                  | shared_trades_trade_id_fkey                   |
| support_replies               | admin_id           | profiles              | id                  | support_replies_admin_id_fkey                 |
| support_replies               | support_request_id | support_requests      | id                  | support_replies_support_request_id_fkey       |
| support_requests              | last_replied_by    | profiles              | id                  | support_requests_last_replied_by_fkey         |
| support_requests              | user_id            | profiles              | id                  | support_requests_user_id_fkey                 |
| tda_analysis_history          | analysis_id        | top_down_analyses     | id                  | tda_analysis_history_analysis_id_fkey         |
| tda_analysis_history          | performed_by       | profiles              | id                  | tda_analysis_history_performed_by_fkey        |
| tda_announcements             | analysis_id        | top_down_analyses     | id                  | tda_announcements_analysis_id_fkey            |
| tda_answers                   | analysis_id        | top_down_analyses     | id                  | tda_answers_analysis_id_fkey                  |
| tda_answers                   | question_id        | tda_questions         | id                  | tda_answers_question_id_fkey                  |
| tda_screenshots               | analysis_id        | top_down_analyses     | id                  | tda_screenshots_analysis_id_fkey              |
| tda_timeframe_analyses        | analysis_id        | top_down_analyses     | id                  | tda_timeframe_analyses_analysis_id_fkey       |
| top_down_analyses             | user_id            | profiles              | id                  | top_down_analyses_user_id_fkey                |
| trade_setup_comment_reactions | comment_id         | trade_setup_comments  | id                  | trade_setup_comment_reactions_comment_id_fkey |
| trade_setup_comment_reactions | user_id            | profiles              | id                  | trade_setup_comment_reactions_user_id_fkey    |
| trade_setup_comments          | parent_id          | trade_setup_comments  | id                  | trade_setup_comments_parent_id_fkey           |
| trade_setup_comments          | trade_setup_id     | trade_setups          | id                  | trade_setup_comments_trade_setup_id_fkey      |
| trade_setup_comments          | user_id            | profiles              | id                  | trade_setup_comments_user_id_fkey             |
| trade_setup_dislikes          | trade_setup_id     | trade_setups          | id                  | trade_setup_dislikes_trade_setup_id_fkey      |
| trade_setup_dislikes          | user_id            | profiles              | id                  | trade_setup_dislikes_user_id_fkey             |
| trade_setup_likes             | trade_setup_id     | trade_setups          | id                  | trade_setup_likes_trade_setup_id_fkey         |
| trade_setup_likes             | user_id            | profiles              | id                  | trade_setup_likes_user_id_fkey                |
| trade_setup_tags              | setup_id           | trade_setups          | id                  | trade_setup_tags_setup_id_fkey                |
| trade_setups                  | user_id            | profiles              | id                  | trade_setups_user_id_fkey                     |
| trader_friends                | action_user_id     | profiles              | id                  | trader_friends_action_user_id_fkey            |
| trader_friends                | user1_id           | profiles              | id                  | trader_friends_user1_id_fkey                  |
| trader_friends                | user2_id           | profiles              | id                  | trader_friends_user2_id_fkey                  |
| trades                        | user_id            | profiles              | id                  | trades_user_id_fkey                           |
| user_presence                 | user_id            | profiles              | id                  | user_presence_user_id_fkey                    |
| user_settings                 | user_id            | profiles              | id                  | user_settings_user_id_fkey                    |

9. SUPABASE all indexes

| schemaname | tablename                     | indexname                                                       | indexdef                                                                                                                                                                                                  |
| ---------- | ----------------------------- | --------------------------------------------------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| public     | audit_logs                    | audit_logs_pkey                                                 | CREATE UNIQUE INDEX audit_logs_pkey ON public.audit_logs USING btree (id)                                                                                                                                 |
| public     | audit_logs                    | idx_audit_logs_created_at                                       | CREATE INDEX idx_audit_logs_created_at ON public.audit_logs USING btree (created_at)                                                                                                                      |
| public     | audit_logs                    | idx_audit_logs_entity                                           | CREATE INDEX idx_audit_logs_entity ON public.audit_logs USING btree (entity_type, entity_id)                                                                                                              |
| public     | audit_logs                    | idx_audit_logs_user_id                                          | CREATE INDEX idx_audit_logs_user_id ON public.audit_logs USING btree (user_id)                                                                                                                            |
| public     | chat_group_invitations        | chat_group_invitations_group_id_invitee_id_key                  | CREATE UNIQUE INDEX chat_group_invitations_group_id_invitee_id_key ON public.chat_group_invitations USING btree (group_id, invitee_id)                                                                    |
| public     | chat_group_invitations        | chat_group_invitations_pkey                                     | CREATE UNIQUE INDEX chat_group_invitations_pkey ON public.chat_group_invitations USING btree (id)                                                                                                         |
| public     | chat_group_invitations        | idx_chat_group_invitations_group_id                             | CREATE INDEX idx_chat_group_invitations_group_id ON public.chat_group_invitations USING btree (group_id)                                                                                                  |
| public     | chat_group_invitations        | idx_chat_group_invitations_invitee_id                           | CREATE INDEX idx_chat_group_invitations_invitee_id ON public.chat_group_invitations USING btree (invitee_id)                                                                                              |
| public     | chat_group_members            | chat_group_members_group_id_user_id_key                         | CREATE UNIQUE INDEX chat_group_members_group_id_user_id_key ON public.chat_group_members USING btree (group_id, user_id)                                                                                  |
| public     | chat_group_members            | chat_group_members_pkey                                         | CREATE UNIQUE INDEX chat_group_members_pkey ON public.chat_group_members USING btree (id)                                                                                                                 |
| public     | chat_group_members            | idx_chat_group_members_group_id                                 | CREATE INDEX idx_chat_group_members_group_id ON public.chat_group_members USING btree (group_id)                                                                                                          |
| public     | chat_group_members            | idx_chat_group_members_user_id                                  | CREATE INDEX idx_chat_group_members_user_id ON public.chat_group_members USING btree (user_id)                                                                                                            |
| public     | chat_groups                   | chat_groups_pkey                                                | CREATE UNIQUE INDEX chat_groups_pkey ON public.chat_groups USING btree (id)                                                                                                                               |
| public     | chat_groups                   | idx_chat_groups_creator_id                                      | CREATE INDEX idx_chat_groups_creator_id ON public.chat_groups USING btree (creator_id)                                                                                                                    |
| public     | chat_groups                   | idx_chat_groups_is_direct                                       | CREATE INDEX idx_chat_groups_is_direct ON public.chat_groups USING btree (is_direct)                                                                                                                      |
| public     | chat_messages                 | chat_messages_pkey                                              | CREATE UNIQUE INDEX chat_messages_pkey ON public.chat_messages USING btree (id)                                                                                                                           |
| public     | chat_messages                 | idx_chat_messages_created_at                                    | CREATE INDEX idx_chat_messages_created_at ON public.chat_messages USING btree (created_at)                                                                                                                |
| public     | chat_messages                 | idx_chat_messages_group_id                                      | CREATE INDEX idx_chat_messages_group_id ON public.chat_messages USING btree (group_id)                                                                                                                    |
| public     | friend_requests               | friend_requests_pkey                                            | CREATE UNIQUE INDEX friend_requests_pkey ON public.friend_requests USING btree (id)                                                                                                                       |
| public     | friend_requests               | friend_requests_sender_id_recipient_id_key                      | CREATE UNIQUE INDEX friend_requests_sender_id_recipient_id_key ON public.friend_requests USING btree (sender_id, recipient_id)                                                                            |
| public     | messages                      | idx_messages_receiver_id                                        | CREATE INDEX idx_messages_receiver_id ON public.messages USING btree (receiver_id)                                                                                                                        |
| public     | messages                      | idx_messages_sender_id                                          | CREATE INDEX idx_messages_sender_id ON public.messages USING btree (sender_id)                                                                                                                            |
| public     | messages                      | messages_pkey                                                   | CREATE UNIQUE INDEX messages_pkey ON public.messages USING btree (id)                                                                                                                                     |
| public     | profiles                      | idx_profiles_email                                              | CREATE INDEX idx_profiles_email ON public.profiles USING btree (email)                                                                                                                                    |
| public     | profiles                      | idx_profiles_username                                           | CREATE INDEX idx_profiles_username ON public.profiles USING btree (username)                                                                                                                              |
| public     | profiles                      | profiles_email_key                                              | CREATE UNIQUE INDEX profiles_email_key ON public.profiles USING btree (email)                                                                                                                             |
| public     | profiles                      | profiles_pkey                                                   | CREATE UNIQUE INDEX profiles_pkey ON public.profiles USING btree (id)                                                                                                                                     |
| public     | profiles                      | profiles_username_key                                           | CREATE UNIQUE INDEX profiles_username_key ON public.profiles USING btree (username)                                                                                                                       |
| public     | shared_trade_comments         | idx_shared_trade_comments_created_at                            | CREATE INDEX idx_shared_trade_comments_created_at ON public.shared_trade_comments USING btree (created_at)                                                                                                |
| public     | shared_trade_comments         | idx_shared_trade_comments_parent_id                             | CREATE INDEX idx_shared_trade_comments_parent_id ON public.shared_trade_comments USING btree (parent_id)                                                                                                  |
| public     | shared_trade_comments         | idx_shared_trade_comments_shared_trade_id                       | CREATE INDEX idx_shared_trade_comments_shared_trade_id ON public.shared_trade_comments USING btree (shared_trade_id)                                                                                      |
| public     | shared_trade_comments         | idx_shared_trade_comments_user_id                               | CREATE INDEX idx_shared_trade_comments_user_id ON public.shared_trade_comments USING btree (user_id)                                                                                                      |
| public     | shared_trade_comments         | shared_trade_comments_pkey                                      | CREATE UNIQUE INDEX shared_trade_comments_pkey ON public.shared_trade_comments USING btree (id)                                                                                                           |
| public     | shared_trade_likes            | idx_shared_trade_likes_shared_trade_id                          | CREATE INDEX idx_shared_trade_likes_shared_trade_id ON public.shared_trade_likes USING btree (shared_trade_id)                                                                                            |
| public     | shared_trade_likes            | idx_shared_trade_likes_user_id                                  | CREATE INDEX idx_shared_trade_likes_user_id ON public.shared_trade_likes USING btree (user_id)                                                                                                            |
| public     | shared_trade_likes            | shared_trade_likes_pkey                                         | CREATE UNIQUE INDEX shared_trade_likes_pkey ON public.shared_trade_likes USING btree (id)                                                                                                                 |
| public     | shared_trade_likes            | shared_trade_likes_shared_trade_id_user_id_key                  | CREATE UNIQUE INDEX shared_trade_likes_shared_trade_id_user_id_key ON public.shared_trade_likes USING btree (shared_trade_id, user_id)                                                                    |
| public     | shared_trades                 | idx_shared_trades_created_at                                    | CREATE INDEX idx_shared_trades_created_at ON public.shared_trades USING btree (created_at)                                                                                                                |
| public     | shared_trades                 | idx_shared_trades_forum_id                                      | CREATE INDEX idx_shared_trades_forum_id ON public.shared_trades USING btree (forum_id)                                                                                                                    |
| public     | shared_trades                 | idx_shared_trades_is_active                                     | CREATE INDEX idx_shared_trades_is_active ON public.shared_trades USING btree (is_active)                                                                                                                  |
| public     | shared_trades                 | idx_shared_trades_original_trade_id                             | CREATE INDEX idx_shared_trades_original_trade_id ON public.shared_trades USING btree (original_trade_id)                                                                                                  |
| public     | shared_trades                 | idx_shared_trades_recipient_id                                  | CREATE INDEX idx_shared_trades_recipient_id ON public.shared_trades USING btree (recipient_id)                                                                                                            |
| public     | shared_trades                 | idx_shared_trades_share_type                                    | CREATE INDEX idx_shared_trades_share_type ON public.shared_trades USING btree (share_type)                                                                                                                |
| public     | shared_trades                 | idx_shared_trades_shared_by_user_id                             | CREATE INDEX idx_shared_trades_shared_by_user_id ON public.shared_trades USING btree (shared_by_user_id)                                                                                                  |
| public     | shared_trades                 | idx_shared_trades_shared_with_user_id                           | CREATE INDEX idx_shared_trades_shared_with_user_id ON public.shared_trades USING btree (shared_with_user_id)                                                                                              |
| public     | shared_trades                 | idx_shared_trades_sharer_id                                     | CREATE INDEX idx_shared_trades_sharer_id ON public.shared_trades USING btree (sharer_id)                                                                                                                  |
| public     | shared_trades                 | idx_shared_trades_trade_id                                      | CREATE INDEX idx_shared_trades_trade_id ON public.shared_trades USING btree (trade_id)                                                                                                                    |
| public     | shared_trades                 | shared_trades_original_trade_id_shared_by_user_id_shared_wi_key | CREATE UNIQUE INDEX shared_trades_original_trade_id_shared_by_user_id_shared_wi_key ON public.shared_trades USING btree (original_trade_id, shared_by_user_id, shared_with_user_id, share_type, forum_id) |
| public     | shared_trades                 | shared_trades_pkey                                              | CREATE UNIQUE INDEX shared_trades_pkey ON public.shared_trades USING btree (id)                                                                                                                           |
| public     | support_replies               | idx_support_replies_admin_id                                    | CREATE INDEX idx_support_replies_admin_id ON public.support_replies USING btree (admin_id)                                                                                                                |
| public     | support_replies               | idx_support_replies_request_id                                  | CREATE INDEX idx_support_replies_request_id ON public.support_replies USING btree (support_request_id)                                                                                                    |
| public     | support_replies               | support_replies_pkey                                            | CREATE UNIQUE INDEX support_replies_pkey ON public.support_replies USING btree (id)                                                                                                                       |
| public     | support_requests              | idx_support_requests_status                                     | CREATE INDEX idx_support_requests_status ON public.support_requests USING btree (status)                                                                                                                  |
| public     | support_requests              | idx_support_requests_user_id                                    | CREATE INDEX idx_support_requests_user_id ON public.support_requests USING btree (user_id)                                                                                                                |
| public     | support_requests              | support_requests_pkey                                           | CREATE UNIQUE INDEX support_requests_pkey ON public.support_requests USING btree (id)                                                                                                                     |
| public     | tda_analysis_history          | tda_analysis_history_pkey                                       | CREATE UNIQUE INDEX tda_analysis_history_pkey ON public.tda_analysis_history USING btree (id)                                                                                                             |
| public     | tda_announcements             | idx_tda_announcements_analysis_id                               | CREATE INDEX idx_tda_announcements_analysis_id ON public.tda_announcements USING btree (analysis_id)                                                                                                      |
| public     | tda_announcements             | idx_tda_announcements_impact_level                              | CREATE INDEX idx_tda_announcements_impact_level ON public.tda_announcements USING btree (impact_level)                                                                                                    |
| public     | tda_announcements             | tda_announcements_pkey                                          | CREATE UNIQUE INDEX tda_announcements_pkey ON public.tda_announcements USING btree (id)                                                                                                                   |
| public     | tda_answers                   | idx_tda_answers_analysis_id                                     | CREATE INDEX idx_tda_answers_analysis_id ON public.tda_answers USING btree (analysis_id)                                                                                                                  |
| public     | tda_answers                   | tda_answers_analysis_id_question_id_key                         | CREATE UNIQUE INDEX tda_answers_analysis_id_question_id_key ON public.tda_answers USING btree (analysis_id, question_id)                                                                                  |
| public     | tda_answers                   | tda_answers_pkey                                                | CREATE UNIQUE INDEX tda_answers_pkey ON public.tda_answers USING btree (id)                                                                                                                               |
| public     | tda_questions                 | idx_tda_questions_active                                        | CREATE INDEX idx_tda_questions_active ON public.tda_questions USING btree (is_active)                                                                                                                     |
| public     | tda_questions                 | idx_tda_questions_timeframe                                     | CREATE INDEX idx_tda_questions_timeframe ON public.tda_questions USING btree (timeframe)                                                                                                                  |
| public     | tda_questions                 | tda_questions_pkey                                              | CREATE UNIQUE INDEX tda_questions_pkey ON public.tda_questions USING btree (id)                                                                                                                           |
| public     | tda_screenshots               | idx_tda_screenshots_analysis_id                                 | CREATE INDEX idx_tda_screenshots_analysis_id ON public.tda_screenshots USING btree (analysis_id)                                                                                                          |
| public     | tda_screenshots               | idx_tda_screenshots_timeframe                                   | CREATE INDEX idx_tda_screenshots_timeframe ON public.tda_screenshots USING btree (timeframe)                                                                                                              |
| public     | tda_screenshots               | tda_screenshots_pkey                                            | CREATE UNIQUE INDEX tda_screenshots_pkey ON public.tda_screenshots USING btree (id)                                                                                                                       |
| public     | tda_timeframe_analyses        | idx_tda_timeframe_analyses_analysis_id                          | CREATE INDEX idx_tda_timeframe_analyses_analysis_id ON public.tda_timeframe_analyses USING btree (analysis_id)                                                                                            |
| public     | tda_timeframe_analyses        | tda_timeframe_analyses_analysis_id_timeframe_key                | CREATE UNIQUE INDEX tda_timeframe_analyses_analysis_id_timeframe_key ON public.tda_timeframe_analyses USING btree (analysis_id, timeframe)                                                                |
| public     | tda_timeframe_analyses        | tda_timeframe_analyses_pkey                                     | CREATE UNIQUE INDEX tda_timeframe_analyses_pkey ON public.tda_timeframe_analyses USING btree (id)                                                                                                         |
| public     | top_down_analyses             | idx_top_down_analyses_currency_pair                             | CREATE INDEX idx_top_down_analyses_currency_pair ON public.top_down_analyses USING btree (currency_pair)                                                                                                  |
| public     | top_down_analyses             | idx_top_down_analyses_date                                      | CREATE INDEX idx_top_down_analyses_date ON public.top_down_analyses USING btree (analysis_date)                                                                                                           |
| public     | top_down_analyses             | idx_top_down_analyses_status                                    | CREATE INDEX idx_top_down_analyses_status ON public.top_down_analyses USING btree (status)                                                                                                                |
| public     | top_down_analyses             | idx_top_down_analyses_user_id                                   | CREATE INDEX idx_top_down_analyses_user_id ON public.top_down_analyses USING btree (user_id)                                                                                                              |
| public     | top_down_analyses             | top_down_analyses_pkey                                          | CREATE UNIQUE INDEX top_down_analyses_pkey ON public.top_down_analyses USING btree (id)                                                                                                                   |
| public     | trade_setup_comment_reactions | idx_trade_setup_comment_reactions_comment_id                    | CREATE INDEX idx_trade_setup_comment_reactions_comment_id ON public.trade_setup_comment_reactions USING btree (comment_id)                                                                                |
| public     | trade_setup_comment_reactions | idx_trade_setup_comment_reactions_type                          | CREATE INDEX idx_trade_setup_comment_reactions_type ON public.trade_setup_comment_reactions USING btree (reaction_type)                                                                                   |
| public     | trade_setup_comment_reactions | idx_trade_setup_comment_reactions_user_id                       | CREATE INDEX idx_trade_setup_comment_reactions_user_id ON public.trade_setup_comment_reactions USING btree (user_id)                                                                                      |
| public     | trade_setup_comment_reactions | trade_setup_comment_reactions_comment_id_user_id_key            | CREATE UNIQUE INDEX trade_setup_comment_reactions_comment_id_user_id_key ON public.trade_setup_comment_reactions USING btree (comment_id, user_id)                                                        |
| public     | trade_setup_comment_reactions | trade_setup_comment_reactions_pkey                              | CREATE UNIQUE INDEX trade_setup_comment_reactions_pkey ON public.trade_setup_comment_reactions USING btree (id)                                                                                           |
| public     | trade_setup_comments          | idx_trade_setup_comments_parent_id                              | CREATE INDEX idx_trade_setup_comments_parent_id ON public.trade_setup_comments USING btree (parent_id)                                                                                                    |
| public     | trade_setup_comments          | idx_trade_setup_comments_trade_setup_id                         | CREATE INDEX idx_trade_setup_comments_trade_setup_id ON public.trade_setup_comments USING btree (trade_setup_id)                                                                                          |
| public     | trade_setup_comments          | idx_trade_setup_comments_user_id                                | CREATE INDEX idx_trade_setup_comments_user_id ON public.trade_setup_comments USING btree (user_id)                                                                                                        |
| public     | trade_setup_comments          | trade_setup_comments_pkey                                       | CREATE UNIQUE INDEX trade_setup_comments_pkey ON public.trade_setup_comments USING btree (id)                                                                                                             |
| public     | trade_setup_dislikes          | idx_trade_setup_dislikes_trade_setup_id                         | CREATE INDEX idx_trade_setup_dislikes_trade_setup_id ON public.trade_setup_dislikes USING btree (trade_setup_id)                                                                                          |
| public     | trade_setup_dislikes          | idx_trade_setup_dislikes_user_id                                | CREATE INDEX idx_trade_setup_dislikes_user_id ON public.trade_setup_dislikes USING btree (user_id)                                                                                                        |
| public     | trade_setup_dislikes          | trade_setup_dislikes_pkey                                       | CREATE UNIQUE INDEX trade_setup_dislikes_pkey ON public.trade_setup_dislikes USING btree (id)                                                                                                             |
| public     | trade_setup_dislikes          | trade_setup_dislikes_trade_setup_id_user_id_key                 | CREATE UNIQUE INDEX trade_setup_dislikes_trade_setup_id_user_id_key ON public.trade_setup_dislikes USING btree (trade_setup_id, user_id)                                                                  |
| public     | trade_setup_likes             | idx_trade_setup_likes_user_id                                   | CREATE INDEX idx_trade_setup_likes_user_id ON public.trade_setup_likes USING btree (user_id)                                                                                                              |
| public     | trade_setup_likes             | trade_setup_likes_pkey                                          | CREATE UNIQUE INDEX trade_setup_likes_pkey ON public.trade_setup_likes USING btree (id)                                                                                                                   |
| public     | trade_setup_likes             | trade_setup_likes_trade_setup_id_user_id_key                    | CREATE UNIQUE INDEX trade_setup_likes_trade_setup_id_user_id_key ON public.trade_setup_likes USING btree (trade_setup_id, user_id)                                                                        |
| public     | trade_setup_tags              | trade_setup_tags_pkey                                           | CREATE UNIQUE INDEX trade_setup_tags_pkey ON public.trade_setup_tags USING btree (id)                                                                                                                     |
| public     | trade_setups                  | idx_trade_setups_comments_count                                 | CREATE INDEX idx_trade_setups_comments_count ON public.trade_setups USING btree (comments_count)                                                                                                          |
| public     | trade_setups                  | idx_trade_setups_currency_pair                                  | CREATE INDEX idx_trade_setups_currency_pair ON public.trade_setups USING btree (currency_pair)                                                                                                            |
| public     | trade_setups                  | idx_trade_setups_forum_id                                       | CREATE INDEX idx_trade_setups_forum_id ON public.trade_setups USING btree (forum_id)                                                                                                                      |
| public     | trade_setups                  | idx_trade_setups_forum_ids                                      | CREATE INDEX idx_trade_setups_forum_ids ON public.trade_setups USING gin (forum_ids)                                                                                                                      |
| public     | trade_setups                  | idx_trade_setups_is_public                                      | CREATE INDEX idx_trade_setups_is_public ON public.trade_setups USING btree (is_public)                                                                                                                    |
| public     | trade_setups                  | idx_trade_setups_likes_count                                    | CREATE INDEX idx_trade_setups_likes_count ON public.trade_setups USING btree (likes_count)                                                                                                                |
| public     | trade_setups                  | idx_trade_setups_pair                                           | CREATE INDEX idx_trade_setups_pair ON public.trade_setups USING btree (pair)                                                                                                                              |
| public     | trade_setups                  | idx_trade_setups_timeframe                                      | CREATE INDEX idx_trade_setups_timeframe ON public.trade_setups USING btree (timeframe)                                                                                                                    |
| public     | trade_setups                  | idx_trade_setups_user_id                                        | CREATE INDEX idx_trade_setups_user_id ON public.trade_setups USING btree (user_id)                                                                                                                        |
| public     | trade_setups                  | trade_setups_pkey                                               | CREATE UNIQUE INDEX trade_setups_pkey ON public.trade_setups USING btree (id)                                                                                                                             |
| public     | trader_friends                | trader_friends_pkey                                             | CREATE UNIQUE INDEX trader_friends_pkey ON public.trader_friends USING btree (id)                                                                                                                         |
| public     | trader_friends                | trader_friends_user1_id_user2_id_key                            | CREATE UNIQUE INDEX trader_friends_user1_id_user2_id_key ON public.trader_friends USING btree (user1_id, user2_id)                                                                                        |
| public     | trades                        | idx_trades_currency_pair                                        | CREATE INDEX idx_trades_currency_pair ON public.trades USING btree (currency_pair)                                                                                                                        |
| public     | trades                        | idx_trades_date                                                 | CREATE INDEX idx_trades_date ON public.trades USING btree (date)                                                                                                                                          |
| public     | trades                        | idx_trades_user_id                                              | CREATE INDEX idx_trades_user_id ON public.trades USING btree (user_id)                                                                                                                                    |
| public     | trades                        | trades_pkey                                                     | CREATE UNIQUE INDEX trades_pkey ON public.trades USING btree (id)                                                                                                                                         |
| public     | user_presence                 | idx_user_presence_status                                        | CREATE INDEX idx_user_presence_status ON public.user_presence USING btree (status)                                                                                                                        |
| public     | user_presence                 | idx_user_presence_user_id                                       | CREATE INDEX idx_user_presence_user_id ON public.user_presence USING btree (user_id)                                                                                                                      |
| public     | user_presence                 | user_presence_pkey                                              | CREATE UNIQUE INDEX user_presence_pkey ON public.user_presence USING btree (id)                                                                                                                           |
| public     | user_presence                 | user_presence_user_id_key                                       | CREATE UNIQUE INDEX user_presence_user_id_key ON public.user_presence USING btree (user_id)                                                                                                               |
| public     | user_settings                 | user_settings_pkey                                              | CREATE UNIQUE INDEX user_settings_pkey ON public.user_settings USING btree (id)                                                                                                                           |
| public     | user_settings                 | user_settings_user_id_key                                       | CREATE UNIQUE INDEX user_settings_user_id_key ON public.user_settings USING btree (user_id)                                                                                                               |

10. SUPABASE ALL CONSTRAINTS

| table_name                    | constraint_name                                                 | constraint_type | column_name         | foreign_table_name            | foreign_column_name |
| ----------------------------- | --------------------------------------------------------------- | --------------- | ------------------- | ----------------------------- | ------------------- |
| audit_logs                    | 2200_17549_1_not_null                                           | CHECK           | null                | null                          | null                |
| audit_logs                    | 2200_17549_3_not_null                                           | CHECK           | null                | null                          | null                |
| audit_logs                    | audit_logs_pkey                                                 | PRIMARY KEY     | id                  | audit_logs                    | id                  |
| chat_group_invitations        | 2200_108030_1_not_null                                          | CHECK           | null                | null                          | null                |
| chat_group_invitations        | chat_group_invitations_group_id_fkey                            | FOREIGN KEY     | group_id            | chat_groups                   | id                  |
| chat_group_invitations        | chat_group_invitations_group_id_invitee_id_key                  | UNIQUE          | invitee_id          | chat_group_invitations        | group_id            |
| chat_group_invitations        | chat_group_invitations_group_id_invitee_id_key                  | UNIQUE          | group_id            | chat_group_invitations        | group_id            |
| chat_group_invitations        | chat_group_invitations_group_id_invitee_id_key                  | UNIQUE          | group_id            | chat_group_invitations        | invitee_id          |
| chat_group_invitations        | chat_group_invitations_group_id_invitee_id_key                  | UNIQUE          | invitee_id          | chat_group_invitations        | invitee_id          |
| chat_group_invitations        | chat_group_invitations_invitee_id_fkey                          | FOREIGN KEY     | invitee_id          | profiles                      | id                  |
| chat_group_invitations        | chat_group_invitations_inviter_id_fkey                          | FOREIGN KEY     | inviter_id          | profiles                      | id                  |
| chat_group_invitations        | chat_group_invitations_pkey                                     | PRIMARY KEY     | id                  | chat_group_invitations        | id                  |
| chat_group_invitations        | chat_group_invitations_status_check                             | CHECK           | null                | chat_group_invitations        | status              |
| chat_group_members            | 2200_108008_1_not_null                                          | CHECK           | null                | null                          | null                |
| chat_group_members            | chat_group_members_group_id_fkey                                | FOREIGN KEY     | group_id            | chat_groups                   | id                  |
| chat_group_members            | chat_group_members_group_id_user_id_key                         | UNIQUE          | user_id             | chat_group_members            | user_id             |
| chat_group_members            | chat_group_members_group_id_user_id_key                         | UNIQUE          | user_id             | chat_group_members            | group_id            |
| chat_group_members            | chat_group_members_group_id_user_id_key                         | UNIQUE          | group_id            | chat_group_members            | user_id             |
| chat_group_members            | chat_group_members_group_id_user_id_key                         | UNIQUE          | group_id            | chat_group_members            | group_id            |
| chat_group_members            | chat_group_members_pkey                                         | PRIMARY KEY     | id                  | chat_group_members            | id                  |
| chat_group_members            | chat_group_members_user_id_fkey                                 | FOREIGN KEY     | user_id             | profiles                      | id                  |
| chat_groups                   | 2200_107992_1_not_null                                          | CHECK           | null                | null                          | null                |
| chat_groups                   | 2200_107992_2_not_null                                          | CHECK           | null                | null                          | null                |
| chat_groups                   | chat_groups_creator_id_fkey                                     | FOREIGN KEY     | creator_id          | profiles                      | id                  |
| chat_groups                   | chat_groups_pkey                                                | PRIMARY KEY     | id                  | chat_groups                   | id                  |
| chat_messages                 | 2200_108059_1_not_null                                          | CHECK           | null                | null                          | null                |
| chat_messages                 | 2200_108059_4_not_null                                          | CHECK           | null                | null                          | null                |
| chat_messages                 | chat_messages_group_id_fkey                                     | FOREIGN KEY     | group_id            | chat_groups                   | id                  |
| chat_messages                 | chat_messages_message_type_check                                | CHECK           | null                | chat_messages                 | message_type        |
| chat_messages                 | chat_messages_pkey                                              | PRIMARY KEY     | id                  | chat_messages                 | id                  |
| chat_messages                 | chat_messages_sender_id_fkey                                    | FOREIGN KEY     | sender_id           | profiles                      | id                  |
| friend_requests               | 2200_24347_1_not_null                                           | CHECK           | null                | null                          | null                |
| friend_requests               | friend_requests_pkey                                            | PRIMARY KEY     | id                  | friend_requests               | id                  |
| friend_requests               | friend_requests_recipient_id_fkey                               | FOREIGN KEY     | recipient_id        | profiles                      | id                  |
| friend_requests               | friend_requests_sender_id_fkey                                  | FOREIGN KEY     | sender_id           | profiles                      | id                  |
| friend_requests               | friend_requests_sender_id_recipient_id_key                      | UNIQUE          | recipient_id        | friend_requests               | recipient_id        |
| friend_requests               | friend_requests_sender_id_recipient_id_key                      | UNIQUE          | sender_id           | friend_requests               | recipient_id        |
| friend_requests               | friend_requests_sender_id_recipient_id_key                      | UNIQUE          | sender_id           | friend_requests               | sender_id           |
| friend_requests               | friend_requests_sender_id_recipient_id_key                      | UNIQUE          | recipient_id        | friend_requests               | sender_id           |
| messages                      | 2200_17699_1_not_null                                           | CHECK           | null                | null                          | null                |
| messages                      | 2200_17699_2_not_null                                           | CHECK           | null                | null                          | null                |
| messages                      | 2200_17699_3_not_null                                           | CHECK           | null                | null                          | null                |
| messages                      | 2200_17699_4_not_null                                           | CHECK           | null                | null                          | null                |
| messages                      | messages_check                                                  | CHECK           | null                | messages                      | receiver_id         |
| messages                      | messages_check                                                  | CHECK           | null                | messages                      | sender_id           |
| messages                      | messages_pkey                                                   | PRIMARY KEY     | id                  | messages                      | id                  |
| messages                      | messages_receiver_id_fkey                                       | FOREIGN KEY     | receiver_id         | profiles                      | id                  |
| messages                      | messages_sender_id_fkey                                         | FOREIGN KEY     | sender_id           | profiles                      | id                  |
| profiles                      | 2200_17309_1_not_null                                           | CHECK           | null                | null                          | null                |
| profiles                      | 2200_17309_3_not_null                                           | CHECK           | null                | null                          | null                |
| profiles                      | profiles_email_key                                              | UNIQUE          | email               | profiles                      | email               |
| profiles                      | profiles_id_fkey                                                | FOREIGN KEY     | id                  | null                          | null                |
| profiles                      | profiles_pkey                                                   | PRIMARY KEY     | id                  | profiles                      | id                  |
| profiles                      | profiles_username_key                                           | UNIQUE          | username            | profiles                      | username            |
| shared_trade_comments         | 2200_35638_1_not_null                                           | CHECK           | null                | null                          | null                |
| shared_trade_comments         | 2200_35638_2_not_null                                           | CHECK           | null                | null                          | null                |
| shared_trade_comments         | 2200_35638_3_not_null                                           | CHECK           | null                | null                          | null                |
| shared_trade_comments         | 2200_35638_4_not_null                                           | CHECK           | null                | null                          | null                |
| shared_trade_comments         | shared_trade_comments_parent_id_fkey                            | FOREIGN KEY     | parent_id           | shared_trade_comments         | id                  |
| shared_trade_comments         | shared_trade_comments_pkey                                      | PRIMARY KEY     | id                  | shared_trade_comments         | id                  |
| shared_trade_comments         | shared_trade_comments_shared_trade_id_fkey                      | FOREIGN KEY     | shared_trade_id     | shared_trades                 | id                  |
| shared_trade_comments         | shared_trade_comments_user_id_fkey                              | FOREIGN KEY     | user_id             | null                          | null                |
| shared_trade_likes            | 2200_35619_1_not_null                                           | CHECK           | null                | null                          | null                |
| shared_trade_likes            | 2200_35619_2_not_null                                           | CHECK           | null                | null                          | null                |
| shared_trade_likes            | 2200_35619_3_not_null                                           | CHECK           | null                | null                          | null                |
| shared_trade_likes            | shared_trade_likes_pkey                                         | PRIMARY KEY     | id                  | shared_trade_likes            | id                  |
| shared_trade_likes            | shared_trade_likes_shared_trade_id_fkey                         | FOREIGN KEY     | shared_trade_id     | shared_trades                 | id                  |
| shared_trade_likes            | shared_trade_likes_shared_trade_id_user_id_key                  | UNIQUE          | shared_trade_id     | shared_trade_likes            | user_id             |
| shared_trade_likes            | shared_trade_likes_shared_trade_id_user_id_key                  | UNIQUE          | user_id             | shared_trade_likes            | user_id             |
| shared_trade_likes            | shared_trade_likes_shared_trade_id_user_id_key                  | UNIQUE          | user_id             | shared_trade_likes            | shared_trade_id     |
| shared_trade_likes            | shared_trade_likes_shared_trade_id_user_id_key                  | UNIQUE          | shared_trade_id     | shared_trade_likes            | shared_trade_id     |
| shared_trade_likes            | shared_trade_likes_user_id_fkey                                 | FOREIGN KEY     | user_id             | null                          | null                |
| shared_trades                 | 2200_35592_1_not_null                                           | CHECK           | null                | null                          | null                |
| shared_trades                 | 2200_35592_2_not_null                                           | CHECK           | null                | null                          | null                |
| shared_trades                 | 2200_35592_3_not_null                                           | CHECK           | null                | null                          | null                |
| shared_trades                 | 2200_35592_5_not_null                                           | CHECK           | null                | null                          | null                |
| shared_trades                 | shared_trades_original_trade_id_fkey                            | FOREIGN KEY     | original_trade_id   | trades                        | id                  |
| shared_trades                 | shared_trades_original_trade_id_shared_by_user_id_shared_wi_key | UNIQUE          | share_type          | shared_trades                 | forum_id            |
| shared_trades                 | shared_trades_original_trade_id_shared_by_user_id_shared_wi_key | UNIQUE          | share_type          | shared_trades                 | original_trade_id   |
| shared_trades                 | shared_trades_original_trade_id_shared_by_user_id_shared_wi_key | UNIQUE          | share_type          | shared_trades                 | share_type          |
| shared_trades                 | shared_trades_original_trade_id_shared_by_user_id_shared_wi_key | UNIQUE          | share_type          | shared_trades                 | shared_by_user_id   |
| shared_trades                 | shared_trades_original_trade_id_shared_by_user_id_shared_wi_key | UNIQUE          | share_type          | shared_trades                 | shared_with_user_id |
| shared_trades                 | shared_trades_original_trade_id_shared_by_user_id_shared_wi_key | UNIQUE          | forum_id            | shared_trades                 | forum_id            |
| shared_trades                 | shared_trades_original_trade_id_shared_by_user_id_shared_wi_key | UNIQUE          | forum_id            | shared_trades                 | original_trade_id   |
| shared_trades                 | shared_trades_original_trade_id_shared_by_user_id_shared_wi_key | UNIQUE          | forum_id            | shared_trades                 | share_type          |
| shared_trades                 | shared_trades_original_trade_id_shared_by_user_id_shared_wi_key | UNIQUE          | forum_id            | shared_trades                 | shared_with_user_id |
| shared_trades                 | shared_trades_original_trade_id_shared_by_user_id_shared_wi_key | UNIQUE          | forum_id            | shared_trades                 | shared_by_user_id   |
| shared_trades                 | shared_trades_original_trade_id_shared_by_user_id_shared_wi_key | UNIQUE          | original_trade_id   | shared_trades                 | forum_id            |
| shared_trades                 | shared_trades_original_trade_id_shared_by_user_id_shared_wi_key | UNIQUE          | original_trade_id   | shared_trades                 | original_trade_id   |
| shared_trades                 | shared_trades_original_trade_id_shared_by_user_id_shared_wi_key | UNIQUE          | original_trade_id   | shared_trades                 | share_type          |
| shared_trades                 | shared_trades_original_trade_id_shared_by_user_id_shared_wi_key | UNIQUE          | original_trade_id   | shared_trades                 | shared_by_user_id   |
| shared_trades                 | shared_trades_original_trade_id_shared_by_user_id_shared_wi_key | UNIQUE          | original_trade_id   | shared_trades                 | shared_with_user_id |
| shared_trades                 | shared_trades_original_trade_id_shared_by_user_id_shared_wi_key | UNIQUE          | shared_by_user_id   | shared_trades                 | forum_id            |
| shared_trades                 | shared_trades_original_trade_id_shared_by_user_id_shared_wi_key | UNIQUE          | shared_by_user_id   | shared_trades                 | original_trade_id   |
| shared_trades                 | shared_trades_original_trade_id_shared_by_user_id_shared_wi_key | UNIQUE          | shared_by_user_id   | shared_trades                 | share_type          |
| shared_trades                 | shared_trades_original_trade_id_shared_by_user_id_shared_wi_key | UNIQUE          | shared_by_user_id   | shared_trades                 | shared_by_user_id   |
| shared_trades                 | shared_trades_original_trade_id_shared_by_user_id_shared_wi_key | UNIQUE          | shared_by_user_id   | shared_trades                 | shared_with_user_id |
| shared_trades                 | shared_trades_original_trade_id_shared_by_user_id_shared_wi_key | UNIQUE          | shared_with_user_id | shared_trades                 | forum_id            |
| shared_trades                 | shared_trades_original_trade_id_shared_by_user_id_shared_wi_key | UNIQUE          | shared_with_user_id | shared_trades                 | original_trade_id   |
| shared_trades                 | shared_trades_original_trade_id_shared_by_user_id_shared_wi_key | UNIQUE          | shared_with_user_id | shared_trades                 | share_type          |
| shared_trades                 | shared_trades_original_trade_id_shared_by_user_id_shared_wi_key | UNIQUE          | shared_with_user_id | shared_trades                 | shared_by_user_id   |
| shared_trades                 | shared_trades_original_trade_id_shared_by_user_id_shared_wi_key | UNIQUE          | shared_with_user_id | shared_trades                 | shared_with_user_id |
| shared_trades                 | shared_trades_pkey                                              | PRIMARY KEY     | id                  | shared_trades                 | id                  |
| shared_trades                 | shared_trades_recipient_id_fkey                                 | FOREIGN KEY     | recipient_id        | profiles                      | id                  |
| shared_trades                 | shared_trades_share_type_check                                  | CHECK           | null                | shared_trades                 | share_type          |
| shared_trades                 | shared_trades_shared_by_user_id_fkey                            | FOREIGN KEY     | shared_by_user_id   | null                          | null                |
| shared_trades                 | shared_trades_shared_with_user_id_fkey                          | FOREIGN KEY     | shared_with_user_id | null                          | null                |
| shared_trades                 | shared_trades_sharer_id_fkey                                    | FOREIGN KEY     | sharer_id           | profiles                      | id                  |
| shared_trades                 | shared_trades_trade_id_fkey                                     | FOREIGN KEY     | trade_id            | trades                        | id                  |
| support_replies               | 2200_17506_1_not_null                                           | CHECK           | null                | null                          | null                |
| support_replies               | 2200_17506_4_not_null                                           | CHECK           | null                | null                          | null                |
| support_replies               | 2200_17506_5_not_null                                           | CHECK           | null                | null                          | null                |
| support_replies               | support_replies_admin_id_fkey                                   | FOREIGN KEY     | admin_id            | profiles                      | id                  |
| support_replies               | support_replies_pkey                                            | PRIMARY KEY     | id                  | support_replies               | id                  |
| support_replies               | support_replies_support_request_id_fkey                         | FOREIGN KEY     | support_request_id  | support_requests              | id                  |
| support_requests              | 2200_17484_1_not_null                                           | CHECK           | null                | null                          | null                |
| support_requests              | 2200_17484_3_not_null                                           | CHECK           | null                | null                          | null                |
| support_requests              | 2200_17484_4_not_null                                           | CHECK           | null                | null                          | null                |
| support_requests              | support_requests_last_replied_by_fkey                           | FOREIGN KEY     | last_replied_by     | profiles                      | id                  |
| support_requests              | support_requests_pkey                                           | PRIMARY KEY     | id                  | support_requests              | id                  |
| support_requests              | support_requests_user_id_fkey                                   | FOREIGN KEY     | user_id             | profiles                      | id                  |
| tda_analysis_history          | 2200_69964_1_not_null                                           | CHECK           | null                | null                          | null                |
| tda_analysis_history          | 2200_69964_2_not_null                                           | CHECK           | null                | null                          | null                |
| tda_analysis_history          | 2200_69964_3_not_null                                           | CHECK           | null                | null                          | null                |
| tda_analysis_history          | tda_analysis_history_analysis_id_fkey                           | FOREIGN KEY     | analysis_id         | top_down_analyses             | id                  |
| tda_analysis_history          | tda_analysis_history_performed_by_fkey                          | FOREIGN KEY     | performed_by        | profiles                      | id                  |
| tda_analysis_history          | tda_analysis_history_pkey                                       | PRIMARY KEY     | id                  | tda_analysis_history          | id                  |
| tda_announcements             | 2200_71492_1_not_null                                           | CHECK           | null                | null                          | null                |
| tda_announcements             | 2200_71492_2_not_null                                           | CHECK           | null                | null                          | null                |
| tda_announcements             | 2200_71492_3_not_null                                           | CHECK           | null                | null                          | null                |
| tda_announcements             | 2200_71492_4_not_null                                           | CHECK           | null                | null                          | null                |
| tda_announcements             | 2200_71492_5_not_null                                           | CHECK           | null                | null                          | null                |
| tda_announcements             | tda_announcements_analysis_id_fkey                              | FOREIGN KEY     | analysis_id         | top_down_analyses             | id                  |
| tda_announcements             | tda_announcements_impact_level_check                            | CHECK           | null                | tda_announcements             | impact_level        |
| tda_announcements             | tda_announcements_pkey                                          | PRIMARY KEY     | id                  | tda_announcements             | id                  |
| tda_answers                   | 2200_69943_1_not_null                                           | CHECK           | null                | null                          | null                |
| tda_answers                   | 2200_69943_2_not_null                                           | CHECK           | null                | null                          | null                |
| tda_answers                   | 2200_69943_3_not_null                                           | CHECK           | null                | null                          | null                |
| tda_answers                   | tda_answers_analysis_id_fkey                                    | FOREIGN KEY     | analysis_id         | top_down_analyses             | id                  |
| tda_answers                   | tda_answers_analysis_id_question_id_key                         | UNIQUE          | analysis_id         | tda_answers                   | question_id         |
| tda_answers                   | tda_answers_analysis_id_question_id_key                         | UNIQUE          | question_id         | tda_answers                   | question_id         |
| tda_answers                   | tda_answers_analysis_id_question_id_key                         | UNIQUE          | question_id         | tda_answers                   | analysis_id         |
| tda_answers                   | tda_answers_analysis_id_question_id_key                         | UNIQUE          | analysis_id         | tda_answers                   | analysis_id         |
| tda_answers                   | tda_answers_pkey                                                | PRIMARY KEY     | id                  | tda_answers                   | id                  |
| tda_answers                   | tda_answers_question_id_fkey                                    | FOREIGN KEY     | question_id         | tda_questions                 | id                  |
| tda_questions                 | 2200_69932_1_not_null                                           | CHECK           | null                | null                          | null                |
| tda_questions                 | 2200_69932_2_not_null                                           | CHECK           | null                | null                          | null                |
| tda_questions                 | 2200_69932_3_not_null                                           | CHECK           | null                | null                          | null                |
| tda_questions                 | 2200_69932_4_not_null                                           | CHECK           | null                | null                          | null                |
| tda_questions                 | 2200_69932_7_not_null                                           | CHECK           | null                | null                          | null                |
| tda_questions                 | tda_questions_pkey                                              | PRIMARY KEY     | id                  | tda_questions                 | id                  |
| tda_screenshots               | 2200_71534_1_not_null                                           | CHECK           | null                | null                          | null                |
| tda_screenshots               | 2200_71534_2_not_null                                           | CHECK           | null                | null                          | null                |
| tda_screenshots               | 2200_71534_3_not_null                                           | CHECK           | null                | null                          | null                |
| tda_screenshots               | 2200_71534_4_not_null                                           | CHECK           | null                | null                          | null                |
| tda_screenshots               | 2200_71534_5_not_null                                           | CHECK           | null                | null                          | null                |
| tda_screenshots               | 2200_71534_6_not_null                                           | CHECK           | null                | null                          | null                |
| tda_screenshots               | tda_screenshots_analysis_id_fkey                                | FOREIGN KEY     | analysis_id         | top_down_analyses             | id                  |
| tda_screenshots               | tda_screenshots_pkey                                            | PRIMARY KEY     | id                  | tda_screenshots               | id                  |
| tda_timeframe_analyses        | 2200_69914_1_not_null                                           | CHECK           | null                | null                          | null                |
| tda_timeframe_analyses        | 2200_69914_2_not_null                                           | CHECK           | null                | null                          | null                |
| tda_timeframe_analyses        | 2200_69914_3_not_null                                           | CHECK           | null                | null                          | null                |
| tda_timeframe_analyses        | 2200_69914_6_not_null                                           | CHECK           | null                | null                          | null                |
| tda_timeframe_analyses        | tda_timeframe_analyses_analysis_id_fkey                         | FOREIGN KEY     | analysis_id         | top_down_analyses             | id                  |
| tda_timeframe_analyses        | tda_timeframe_analyses_analysis_id_timeframe_key                | UNIQUE          | timeframe           | tda_timeframe_analyses        | timeframe           |
| tda_timeframe_analyses        | tda_timeframe_analyses_analysis_id_timeframe_key                | UNIQUE          | analysis_id         | tda_timeframe_analyses        | analysis_id         |
| tda_timeframe_analyses        | tda_timeframe_analyses_analysis_id_timeframe_key                | UNIQUE          | analysis_id         | tda_timeframe_analyses        | timeframe           |
| tda_timeframe_analyses        | tda_timeframe_analyses_analysis_id_timeframe_key                | UNIQUE          | timeframe           | tda_timeframe_analyses        | analysis_id         |
| tda_timeframe_analyses        | tda_timeframe_analyses_pkey                                     | PRIMARY KEY     | id                  | tda_timeframe_analyses        | id                  |
| top_down_analyses             | 2200_69897_1_not_null                                           | CHECK           | null                | null                          | null                |
| top_down_analyses             | 2200_69897_2_not_null                                           | CHECK           | null                | null                          | null                |
| top_down_analyses             | 2200_69897_3_not_null                                           | CHECK           | null                | null                          | null                |
| top_down_analyses             | 2200_69897_4_not_null                                           | CHECK           | null                | null                          | null                |
| top_down_analyses             | 2200_69897_5_not_null                                           | CHECK           | null                | null                          | null                |
| top_down_analyses             | top_down_analyses_pkey                                          | PRIMARY KEY     | id                  | top_down_analyses             | id                  |
| top_down_analyses             | top_down_analyses_user_id_fkey                                  | FOREIGN KEY     | user_id             | profiles                      | id                  |
| trade_setup_comment_reactions | 2200_98916_1_not_null                                           | CHECK           | null                | null                          | null                |
| trade_setup_comment_reactions | 2200_98916_2_not_null                                           | CHECK           | null                | null                          | null                |
| trade_setup_comment_reactions | 2200_98916_3_not_null                                           | CHECK           | null                | null                          | null                |
| trade_setup_comment_reactions | 2200_98916_4_not_null                                           | CHECK           | null                | null                          | null                |
| trade_setup_comment_reactions | trade_setup_comment_reactions_comment_id_fkey                   | FOREIGN KEY     | comment_id          | trade_setup_comments          | id                  |
| trade_setup_comment_reactions | trade_setup_comment_reactions_comment_id_user_id_key            | UNIQUE          | user_id             | trade_setup_comment_reactions | comment_id          |
| trade_setup_comment_reactions | trade_setup_comment_reactions_comment_id_user_id_key            | UNIQUE          | comment_id          | trade_setup_comment_reactions | comment_id          |
| trade_setup_comment_reactions | trade_setup_comment_reactions_comment_id_user_id_key            | UNIQUE          | comment_id          | trade_setup_comment_reactions | user_id             |
| trade_setup_comment_reactions | trade_setup_comment_reactions_comment_id_user_id_key            | UNIQUE          | user_id             | trade_setup_comment_reactions | user_id             |
| trade_setup_comment_reactions | trade_setup_comment_reactions_pkey                              | PRIMARY KEY     | id                  | trade_setup_comment_reactions | id                  |
| trade_setup_comment_reactions | trade_setup_comment_reactions_reaction_type_check               | CHECK           | null                | trade_setup_comment_reactions | reaction_type       |
| trade_setup_comment_reactions | trade_setup_comment_reactions_user_id_fkey                      | FOREIGN KEY     | user_id             | profiles                      | id                  |
| trade_setup_comments          | 2200_17381_1_not_null                                           | CHECK           | null                | null                          | null                |
| trade_setup_comments          | 2200_17381_5_not_null                                           | CHECK           | null                | null                          | null                |
| trade_setup_comments          | trade_setup_comments_parent_id_fkey                             | FOREIGN KEY     | parent_id           | trade_setup_comments          | id                  |
| trade_setup_comments          | trade_setup_comments_pkey                                       | PRIMARY KEY     | id                  | trade_setup_comments          | id                  |
| trade_setup_comments          | trade_setup_comments_trade_setup_id_fkey                        | FOREIGN KEY     | trade_setup_id      | trade_setups                  | id                  |
| trade_setup_comments          | trade_setup_comments_user_id_fkey                               | FOREIGN KEY     | user_id             | profiles                      | id                  |
| trade_setup_dislikes          | 2200_98990_1_not_null                                           | CHECK           | null                | null                          | null                |
| trade_setup_dislikes          | 2200_98990_2_not_null                                           | CHECK           | null                | null                          | null                |
| trade_setup_dislikes          | 2200_98990_3_not_null                                           | CHECK           | null                | null                          | null                |
| trade_setup_dislikes          | trade_setup_dislikes_pkey                                       | PRIMARY KEY     | id                  | trade_setup_dislikes          | id                  |
| trade_setup_dislikes          | trade_setup_dislikes_trade_setup_id_fkey                        | FOREIGN KEY     | trade_setup_id      | trade_setups                  | id                  |
| trade_setup_dislikes          | trade_setup_dislikes_trade_setup_id_user_id_key                 | UNIQUE          | trade_setup_id      | trade_setup_dislikes          | user_id             |
| trade_setup_dislikes          | trade_setup_dislikes_trade_setup_id_user_id_key                 | UNIQUE          | trade_setup_id      | trade_setup_dislikes          | trade_setup_id      |
| trade_setup_dislikes          | trade_setup_dislikes_trade_setup_id_user_id_key                 | UNIQUE          | user_id             | trade_setup_dislikes          | user_id             |
| trade_setup_dislikes          | trade_setup_dislikes_trade_setup_id_user_id_key                 | UNIQUE          | user_id             | trade_setup_dislikes          | trade_setup_id      |
| trade_setup_dislikes          | trade_setup_dislikes_user_id_fkey                               | FOREIGN KEY     | user_id             | profiles                      | id                  |
| trade_setup_likes             | 2200_17406_1_not_null                                           | CHECK           | null                | null                          | null                |
| trade_setup_likes             | trade_setup_likes_pkey                                          | PRIMARY KEY     | id                  | trade_setup_likes             | id                  |
| trade_setup_likes             | trade_setup_likes_trade_setup_id_fkey                           | FOREIGN KEY     | trade_setup_id      | trade_setups                  | id                  |
| trade_setup_likes             | trade_setup_likes_trade_setup_id_user_id_key                    | UNIQUE          | trade_setup_id      | trade_setup_likes             | user_id             |
| trade_setup_likes             | trade_setup_likes_trade_setup_id_user_id_key                    | UNIQUE          | trade_setup_id      | trade_setup_likes             | trade_setup_id      |
| trade_setup_likes             | trade_setup_likes_trade_setup_id_user_id_key                    | UNIQUE          | user_id             | trade_setup_likes             | user_id             |
| trade_setup_likes             | trade_setup_likes_trade_setup_id_user_id_key                    | UNIQUE          | user_id             | trade_setup_likes             | trade_setup_id      |
| trade_setup_likes             | trade_setup_likes_user_id_fkey                                  | FOREIGN KEY     | user_id             | profiles                      | id                  |
| trade_setup_tags              | 2200_24334_1_not_null                                           | CHECK           | null                | null                          | null                |
| trade_setup_tags              | 2200_24334_3_not_null                                           | CHECK           | null                | null                          | null                |
| trade_setup_tags              | trade_setup_tags_pkey                                           | PRIMARY KEY     | id                  | trade_setup_tags              | id                  |
| trade_setup_tags              | trade_setup_tags_setup_id_fkey                                  | FOREIGN KEY     | setup_id            | trade_setups                  | id                  |
| trade_setups                  | 2200_17365_1_not_null                                           | CHECK           | null                | null                          | null                |
| trade_setups                  | 2200_17365_3_not_null                                           | CHECK           | null                | null                          | null                |
| trade_setups                  | 2200_17365_5_not_null                                           | CHECK           | null                | null                          | null                |
| trade_setups                  | 2200_17365_6_not_null                                           | CHECK           | null                | null                          | null                |
| trade_setups                  | 2200_17365_7_not_null                                           | CHECK           | null                | null                          | null                |
| trade_setups                  | trade_setups_pkey                                               | PRIMARY KEY     | id                  | trade_setups                  | id                  |
| trade_setups                  | trade_setups_user_id_fkey                                       | FOREIGN KEY     | user_id             | profiles                      | id                  |
| trader_friends                | 2200_17675_1_not_null                                           | CHECK           | null                | null                          | null                |
| trader_friends                | 2200_17675_2_not_null                                           | CHECK           | null                | null                          | null                |
| trader_friends                | 2200_17675_3_not_null                                           | CHECK           | null                | null                          | null                |
| trader_friends                | 2200_17675_4_not_null                                           | CHECK           | null                | null                          | null                |
| trader_friends                | trader_friends_action_user_id_fkey                              | FOREIGN KEY     | action_user_id      | profiles                      | id                  |
| trader_friends                | trader_friends_check                                            | CHECK           | null                | trader_friends                | user2_id            |
| trader_friends                | trader_friends_check                                            | CHECK           | null                | trader_friends                | user1_id            |
| trader_friends                | trader_friends_pkey                                             | PRIMARY KEY     | id                  | trader_friends                | id                  |
| trader_friends                | trader_friends_user1_id_fkey                                    | FOREIGN KEY     | user1_id            | profiles                      | id                  |
| trader_friends                | trader_friends_user1_id_user2_id_key                            | UNIQUE          | user2_id            | trader_friends                | user1_id            |
| trader_friends                | trader_friends_user1_id_user2_id_key                            | UNIQUE          | user1_id            | trader_friends                | user1_id            |
| trader_friends                | trader_friends_user1_id_user2_id_key                            | UNIQUE          | user1_id            | trader_friends                | user2_id            |
| trader_friends                | trader_friends_user1_id_user2_id_key                            | UNIQUE          | user2_id            | trader_friends                | user2_id            |
| trader_friends                | trader_friends_user2_id_fkey                                    | FOREIGN KEY     | user2_id            | profiles                      | id                  |
| trades                        | 2200_17328_1_not_null                                           | CHECK           | null                | null                          | null                |
| trades                        | 2200_17328_24_not_null                                          | CHECK           | null                | null                          | null                |
| trades                        | 2200_17328_3_not_null                                           | CHECK           | null                | null                          | null                |
| trades                        | 2200_17328_4_not_null                                           | CHECK           | null                | null                          | null                |
| trades                        | 2200_17328_5_not_null                                           | CHECK           | null                | null                          | null                |
| trades                        | 2200_17328_9_not_null                                           | CHECK           | null                | null                          | null                |
| trades                        | trades_pkey                                                     | PRIMARY KEY     | id                  | trades                        | id                  |
| trades                        | trades_user_id_fkey                                             | FOREIGN KEY     | user_id             | profiles                      | id                  |
| user_presence                 | 2200_17425_1_not_null                                           | CHECK           | null                | null                          | null                |
| user_presence                 | user_presence_pkey                                              | PRIMARY KEY     | id                  | user_presence                 | id                  |
| user_presence                 | user_presence_user_id_fkey                                      | FOREIGN KEY     | user_id             | profiles                      | id                  |
| user_presence                 | user_presence_user_id_key                                       | UNIQUE          | user_id             | user_presence                 | user_id             |
| user_settings                 | 2200_17345_1_not_null                                           | CHECK           | null                | null                          | null                |
| user_settings                 | 2200_17345_20_not_null                                          | CHECK           | null                | null                          | null                |
| user_settings                 | user_settings_performance_view_check                            | CHECK           | null                | user_settings                 | performance_view    |
| user_settings                 | user_settings_pkey                                              | PRIMARY KEY     | id                  | user_settings                 | id                  |
| user_settings                 | user_settings_user_id_fkey                                      | FOREIGN KEY     | user_id             | profiles                      | id                  |
| user_settings                 | user_settings_user_id_key                                       | UNIQUE          | user_id             | user_settings                 | user_id             |

11-15. Individual table structures

user_settings table structure:

| column_name             | data_type                | is_nullable | column_default     | character_maximum_length | numeric_precision | numeric_scale |
| ----------------------- | ------------------------ | ----------- | ------------------ | ------------------------ | ----------------- | ------------- |
| id                      | uuid                     | NO          | uuid_generate_v4() | null                     | null              | null          |
| user_id                 | uuid                     | YES         | null               | null                     | null              | null          |
| theme                   | text                     | YES         | 'light'::text      | null                     | null              | null          |
| notifications_enabled   | boolean                  | YES         | true               | null                     | null              | null          |
| email_notifications     | boolean                  | YES         | true               | null                     | null              | null          |
| default_currency        | text                     | YES         | 'USD'::text        | null                     | null              | null          |
| timezone                | text                     | YES         | 'UTC'::text        | null                     | null              | null          |
| created_at              | timestamp with time zone | YES         | now()              | null                     | null              | null          |
| updated_at              | timestamp with time zone | YES         | now()              | null                     | null              | null          |
| pips_or_percentage      | text                     | YES         | 'currency'::text   | null                     | null              | null          |
| chart_timeframe         | text                     | YES         | 'daily'::text      | null                     | null              | null          |
| share_statistics        | boolean                  | YES         | false              | null                     | null              | null          |
| public_profile          | boolean                  | YES         | false              | null                     | null              | null          |
| weekly_reports          | boolean                  | YES         | false              | null                     | null              | null          |
| monthly_reports         | boolean                  | YES         | false              | null                     | null              | null          |
| quarterly_reports       | boolean                  | YES         | false              | null                     | null              | null          |
| yearly_reports          | boolean                  | YES         | false              | null                     | null              | null          |
| ai_api_key              | text                     | YES         | null               | null                     | null              | null          |
| monthly_trade_checkup   | boolean                  | YES         | false              | null                     | null              | null          |
| email_project_updates   | boolean                  | NO          | false              | null                     | null              | null          |
| recent_trades_count     | integer                  | YES         | 5                  | null                     | 32                | 0             |
| email_friend_requests   | boolean                  | YES         | false              | null                     | null              | null          |
| email_trade_shared      | boolean                  | YES         | false              | null                     | null              | null          |
| email_medal_achievement | boolean                  | YES         | false              | null                     | null              | null          |
| push_friend_requests    | boolean                  | YES         | false              | null                     | null              | null          |
| push_trade_shared       | boolean                  | YES         | false              | null                     | null              | null          |
| push_medal_achievement  | boolean                  | YES         | false              | null                     | null              | null          |
| performance_view        | text                     | YES         | 'total'::text      | null                     | null              | null          |

trade_setups tabe structure:

| column_name       | data_type                | is_nullable | column_default     | character_maximum_length | numeric_precision | numeric_scale |
| ----------------- | ------------------------ | ----------- | ------------------ | ------------------------ | ----------------- | ------------- |
| id                | uuid                     | NO          | uuid_generate_v4() | null                     | null              | null          |
| user_id           | uuid                     | YES         | null               | null                     | null              | null          |
| title             | text                     | NO          | null               | null                     | null              | null          |
| description       | text                     | YES         | null               | null                     | null              | null          |
| currency_pair     | text                     | NO          | null               | null                     | null              | null          |
| direction         | USER-DEFINED             | NO          | null               | null                     | null              | null          |
| entry_price       | numeric                  | NO          | null               | null                     | 18                | 8             |
| stop_loss         | numeric                  | YES         | null               | null                     | 18                | 8             |
| take_profit       | numeric                  | YES         | null               | null                     | 18                | 8             |
| risk_reward_ratio | numeric                  | YES         | null               | null                     | 5                 | 2             |
| chart_image_url   | text                     | YES         | null               | null                     | null              | null          |
| is_public         | boolean                  | YES         | false              | null                     | null              | null          |
| created_at        | timestamp with time zone | YES         | now()              | null                     | null              | null          |
| updated_at        | timestamp with time zone | YES         | now()              | null                     | null              | null          |
| likes_count       | integer                  | YES         | 0                  | null                     | 32                | 0             |
| comments_count    | integer                  | YES         | 0                  | null                     | 32                | 0             |
| forum_id          | text                     | YES         | null               | null                     | null              | null          |
| forum_ids         | ARRAY                    | YES         | null               | null                     | null              | null          |
| image_urls        | ARRAY                    | YES         | null               | null                     | null              | null          |
| target_price      | numeric                  | YES         | null               | null                     | 18                | 8             |
| timeframe         | text                     | YES         | null               | null                     | null              | null          |
| tags              | ARRAY                    | YES         | null               | null                     | null              | null          |
| pair              | text                     | YES         | null               | null                     | null              | null          |
| dislikes_count    | integer                  | YES         | 0                  | null                     | 32                | 0             |

trader_friends table structure:

| column_name    | data_type                | is_nullable | column_default    | character_maximum_length | numeric_precision | numeric_scale |
| -------------- | ------------------------ | ----------- | ----------------- | ------------------------ | ----------------- | ------------- |
| id             | uuid                     | NO          | gen_random_uuid() | null                     | null              | null          |
| user1_id       | uuid                     | NO          | null              | null                     | null              | null          |
| user2_id       | uuid                     | NO          | null              | null                     | null              | null          |
| status         | text                     | NO          | 'PENDING'::text   | null                     | null              | null          |
| created_at     | timestamp with time zone | YES         | now()             | null                     | null              | null          |
| updated_at     | timestamp with time zone | YES         | now()             | null                     | null              | null          |
| action_user_id | uuid                     | YES         | null              | null                     | null              | null          |

shared_trades table structure:

| column_name         | data_type                | is_nullable | column_default    | character_maximum_length | numeric_precision | numeric_scale |
| ------------------- | ------------------------ | ----------- | ----------------- | ------------------------ | ----------------- | ------------- |
| id                  | uuid                     | NO          | gen_random_uuid() | null                     | null              | null          |
| original_trade_id   | uuid                     | NO          | null              | null                     | null              | null          |
| shared_by_user_id   | uuid                     | NO          | null              | null                     | null              | null          |
| shared_with_user_id | uuid                     | YES         | null              | null                     | null              | null          |
| share_type          | character varying        | NO          | null              | 20                       | null              | null          |
| forum_id            | character varying        | YES         | null              | 50                       | null              | null          |
| is_active           | boolean                  | YES         | true              | null                     | null              | null          |
| created_at          | timestamp with time zone | YES         | now()             | null                     | null              | null          |
| updated_at          | timestamp with time zone | YES         | now()             | null                     | null              | null          |
| trade_id            | uuid                     | YES         | null              | null                     | null              | null          |
| sharer_id           | uuid                     | YES         | null              | null                     | null              | null          |
| recipient_id        | uuid                     | YES         | null              | null                     | null              | null          |


16. Supabase all functions

| schema | function_name                     | arguments                                                                                                                                                                                          | result_type                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| ------ | --------------------------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| public | bytea_to_text                     | data bytea                                                                                                                                                                                         | text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| public | call_monthly_reports              |                                                                                                                                                                                                    | void                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| public | call_weekly_reports               |                                                                                                                                                                                                    | void                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| public | check_cron_jobs                   | job_name text DEFAULT NULL::text, hours_threshold integer DEFAULT 24                                                                                                                               | boolean                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| public | cleanup_old_messages              |                                                                                                                                                                                                    | void                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| public | cleanup_user_data                 | user_id_param uuid                                                                                                                                                                                 | void                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| public | complete_tda_analysis             | p_analysis_id uuid, p_overall_probability numeric, p_trade_recommendation trade_recommendation, p_confidence_level numeric, p_risk_level character varying, p_ai_summary text, p_ai_reasoning text | void                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| public | create_or_get_direct_chat         | recipient_id_param uuid                                                                                                                                                                            | TABLE(group_id uuid)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| public | create_tda_analysis               | p_user_id uuid, p_currency_pair character varying, p_notes text DEFAULT NULL::text                                                                                                                 | uuid                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| public | decrement_comments_count          | p_trade_setup_id uuid                                                                                                                                                                              | void                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| public | decrement_likes_count             | p_trade_setup_id uuid                                                                                                                                                                              | void                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| public | enable_user_reports               | user_id uuid, weekly boolean DEFAULT false, monthly boolean DEFAULT false, quarterly boolean DEFAULT false, yearly boolean DEFAULT false                                                           | void                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| public | get_comment_with_reactions        | comment_id uuid                                                                                                                                                                                    | TABLE(id uuid, trade_setup_id uuid, user_id uuid, content text, created_at timestamp with time zone, updated_at timestamp with time zone, parent_id uuid, likes_count integer, dislikes_count integer, is_edited boolean, edited_at timestamp with time zone, user_reaction text, user_username text, user_avatar_url text)                                                                                                                                                                                                                                           |
| public | get_shared_trades                 | p_user_id uuid DEFAULT NULL::uuid, p_share_type character varying DEFAULT NULL::character varying, p_forum_id character varying DEFAULT NULL::character varying                                    | TABLE(shared_trade_id uuid, original_trade_id uuid, shared_by_user_id uuid, shared_by_username character varying, shared_by_avatar_url text, share_type character varying, forum_id character varying, created_at timestamp with time zone, likes_count bigint, comments_count bigint, currency_pair character varying, trade_type character varying, entry_price numeric, exit_price numeric, entry_time timestamp with time zone, exit_time timestamp with time zone, duration integer, pips numeric, lot_size numeric, profit_loss numeric, date date, notes text) |
| public | get_shared_trades_for_user        | p_user_id uuid DEFAULT auth.uid()                                                                                                                                                                  | TABLE(shared_trade_id uuid, trade_id uuid, sharer_id uuid, sharer_username text, sharer_avatar_url text, recipient_id uuid, recipient_username text, recipient_avatar_url text, shared_at timestamp with time zone, trade_currency_pair text, trade_direction text, trade_entry_price numeric, trade_exit_price numeric, trade_pnl numeric, trade_status text, trade_date timestamp with time zone, likes_count bigint, comments_count bigint, is_liked boolean, is_friend boolean, share_type text)                                                                  |
| public | get_user_profile                  | user_id uuid                                                                                                                                                                                       | TABLE(id uuid, username text, email text, avatar_url text, bio text, website text, role text, performance_rank integer, win_rate numeric, created_at timestamp with time zone, updated_at timestamp with time zone, trader_status text, trader_type text, years_experience text, trading_frequency text, markets text, trading_goal text, trading_challenges text, first_name text, last_name text)                                                                                                                                                                   |
| public | get_users_with_reports_enabled    | report_type text                                                                                                                                                                                   | TABLE(user_id uuid, email text, username text)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| public | handle_comment_edit               |                                                                                                                                                                                                    | trigger                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| public | handle_comment_inserted           |                                                                                                                                                                                                    | trigger                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| public | handle_message_status             |                                                                                                                                                                                                    | trigger                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| public | handle_new_user                   |                                                                                                                                                                                                    | trigger                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| public | handle_new_user_profile           |                                                                                                                                                                                                    | trigger                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| public | handle_profile_changes            |                                                                                                                                                                                                    | trigger                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| public | handle_support_changes            |                                                                                                                                                                                                    | trigger                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| public | handle_trade_changes              |                                                                                                                                                                                                    | trigger                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| public | handle_user_deletion              |                                                                                                                                                                                                    | trigger                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| public | handle_user_update                |                                                                                                                                                                                                    | trigger                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| public | http                              | request http_request                                                                                                                                                                               | http_response                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| public | http_delete                       | uri character varying                                                                                                                                                                              | http_response                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| public | http_delete                       | uri character varying, content character varying, content_type character varying                                                                                                                   | http_response                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| public | http_get                          | uri character varying, data jsonb                                                                                                                                                                  | http_response                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| public | http_get                          | uri character varying                                                                                                                                                                              | http_response                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| public | http_head                         | uri character varying                                                                                                                                                                              | http_response                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| public | http_header                       | field character varying, value character varying                                                                                                                                                   | http_header                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| public | http_list_curlopt                 |                                                                                                                                                                                                    | TABLE(curlopt text, value text)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| public | http_patch                        | uri character varying, content character varying, content_type character varying                                                                                                                   | http_response                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| public | http_post                         | uri character varying, data jsonb                                                                                                                                                                  | http_response                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| public | http_post                         | uri character varying, content character varying, content_type character varying                                                                                                                   | http_response                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| public | http_put                          | uri character varying, content character varying, content_type character varying                                                                                                                   | http_response                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| public | http_reset_curlopt                |                                                                                                                                                                                                    | boolean                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| public | http_set_curlopt                  | curlopt character varying, value character varying                                                                                                                                                 | boolean                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| public | increment_comments_count          | row_id uuid                                                                                                                                                                                        | integer                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| public | increment_likes_count             | p_trade_setup_id uuid                                                                                                                                                                              | void                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| public | mark_inactive_users               |                                                                                                                                                                                                    | void                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| public | share_trade                       | p_trade_id uuid, p_share_type character varying, p_shared_with_user_id uuid DEFAULT NULL::uuid, p_forum_id character varying DEFAULT NULL::character varying                                       | uuid                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| public | share_trade_with_user             | p_trade_id uuid, p_recipient_username text                                                                                                                                                         | uuid                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| public | text_to_bytea                     | data text                                                                                                                                                                                          | bytea                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| public | trigger_periodic_trade_reports    |                                                                                                                                                                                                    | void                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| public | unshare_trade                     | p_trade_id uuid, p_share_type character varying, p_shared_with_user_id uuid DEFAULT NULL::uuid, p_forum_id character varying DEFAULT NULL::character varying                                       | boolean                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| public | update_comment_reaction_counts    |                                                                                                                                                                                                    | trigger                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| public | update_modified_column            |                                                                                                                                                                                                    | trigger                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| public | update_trade_setup_dislikes_count |                                                                                                                                                                                                    | trigger                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| public | update_updated_at_column          |                                                                                                                                                                                                    | trigger                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| public | update_user_presence              |                                                                                                                                                                                                    | trigger                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| public | update_user_profile               | user_id uuid, profile_data jsonb                                                                                                                                                                   | jsonb                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| public | urlencode                         | data jsonb                                                                                                                                                                                         | text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| public | urlencode                         | string character varying                                                                                                                                                                           | text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| public | urlencode                         | string bytea                                                                                                                                                                                       | text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |

17. Supabase all triggers

| trigger_name                            | event_manipulation | event_object_table            | action_statement                                     | action_timing |
| --------------------------------------- | ------------------ | ----------------------------- | ---------------------------------------------------- | ------------- |
| before_message_update                   | UPDATE             | messages                      | EXECUTE FUNCTION handle_message_status()             | BEFORE        |
| after_profile_delete                    | DELETE             | profiles                      | EXECUTE FUNCTION handle_profile_changes()            | AFTER         |
| after_profile_update                    | UPDATE             | profiles                      | EXECUTE FUNCTION handle_profile_changes()            | AFTER         |
| update_shared_trade_comments_updated_at | UPDATE             | shared_trade_comments         | EXECUTE FUNCTION update_updated_at_column()          | BEFORE        |
| update_shared_trades_updated_at         | UPDATE             | shared_trades                 | EXECUTE FUNCTION update_updated_at_column()          | BEFORE        |
| update_support_replies_modtime          | UPDATE             | support_replies               | EXECUTE FUNCTION update_modified_column()            | BEFORE        |
| after_support_update                    | UPDATE             | support_requests              | EXECUTE FUNCTION handle_support_changes()            | AFTER         |
| update_support_requests_modtime         | UPDATE             | support_requests              | EXECUTE FUNCTION update_modified_column()            | BEFORE        |
| trigger_update_comment_reaction_counts  | INSERT             | trade_setup_comment_reactions | EXECUTE FUNCTION update_comment_reaction_counts()    | AFTER         |
| trigger_update_comment_reaction_counts  | UPDATE             | trade_setup_comment_reactions | EXECUTE FUNCTION update_comment_reaction_counts()    | AFTER         |
| trigger_update_comment_reaction_counts  | DELETE             | trade_setup_comment_reactions | EXECUTE FUNCTION update_comment_reaction_counts()    | AFTER         |
| on_comment_inserted                     | INSERT             | trade_setup_comments          | EXECUTE FUNCTION handle_comment_inserted()           | AFTER         |
| trigger_handle_comment_edit             | UPDATE             | trade_setup_comments          | EXECUTE FUNCTION handle_comment_edit()               | BEFORE        |
| trade_setup_dislikes_count_trigger      | INSERT             | trade_setup_dislikes          | EXECUTE FUNCTION update_trade_setup_dislikes_count() | AFTER         |
| trade_setup_dislikes_count_trigger      | DELETE             | trade_setup_dislikes          | EXECUTE FUNCTION update_trade_setup_dislikes_count() | AFTER         |
| after_trade_delete                      | DELETE             | trades                        | EXECUTE FUNCTION handle_trade_changes()              | AFTER         |
| after_trade_insert                      | INSERT             | trades                        | EXECUTE FUNCTION handle_trade_changes()              | AFTER         |
| after_trade_update                      | UPDATE             | trades                        | EXECUTE FUNCTION handle_trade_changes()              | AFTER         |
| trades_audit_trigger                    | INSERT             | trades                        | EXECUTE FUNCTION handle_trade_changes()              | AFTER         |
| trades_audit_trigger                    | UPDATE             | trades                        | EXECUTE FUNCTION handle_trade_changes()              | AFTER         |
| trades_audit_trigger                    | DELETE             | trades                        | EXECUTE FUNCTION handle_trade_changes()              | AFTER         |

All database triggers

| schemaname | tablename              | attname               | n_distinct | correlation |
| ---------- | ---------------------- | --------------------- | ---------- | ----------- |
| public     | audit_logs             | action                | 2          | 1           |
| public     | audit_logs             | created_at            | -0.647059  | 1           |
| public     | audit_logs             | entity_id             | -0.0196078 | null        |
| public     | audit_logs             | entity_type           | -0.0196078 | null        |
| public     | audit_logs             | event_type            | -0.137255  | -0.326579   |
| public     | audit_logs             | id                    | -1         | 0.0501357   |
| public     | audit_logs             | ip_address            | 0          | null        |
| public     | audit_logs             | new_data              | -0.372549  | 0.400427    |
| public     | audit_logs             | new_values            | -0.0196078 | null        |
| public     | audit_logs             | old_data              | -0.333333  | 0.725592    |
| public     | audit_logs             | old_values            | 0          | null        |
| public     | audit_logs             | record_id             | -0.254902  | -0.0971429  |
| public     | audit_logs             | table_name            | 3          | 0.848163    |
| public     | audit_logs             | user_agent            | 0          | null        |
| public     | audit_logs             | user_id               | 5          | -0.179832   |
| public     | profiles               | avatar_url            | -0.5       | null        |
| public     | profiles               | bio                   | -1         | 1           |
| public     | profiles               | created_at            | -1         | -1          |
| public     | profiles               | email                 | -1         | 1           |
| public     | profiles               | first_name            | -0.5       | null        |
| public     | profiles               | id                    | -1         | -1          |
| public     | profiles               | last_name             | -0.5       | null        |
| public     | profiles               | markets               | -0.5       | 1           |
| public     | profiles               | performance_rank      | 0          | null        |
| public     | profiles               | role                  | -1         | -1          |
| public     | profiles               | trader_status         | -0.5       | 1           |
| public     | profiles               | trader_type           | -0.5       | 1           |
| public     | profiles               | trading_challenges    | -0.5       | 1           |
| public     | profiles               | trading_frequency     | -0.5       | 1           |
| public     | profiles               | trading_goal          | -0.5       | 1           |
| public     | profiles               | updated_at            | -1         | 1           |
| public     | profiles               | username              | -1         | -1          |
| public     | profiles               | website               | 0          | null        |
| public     | profiles               | win_rate              | 0          | null        |
| public     | profiles               | years_experience      | -0.5       | null        |
| public     | tda_analysis_history   | action                | -0.111111  | 0.96904     |
| public     | tda_analysis_history   | analysis_id           | -0.944444  | 0.0650155   |
| public     | tda_analysis_history   | changes               | -0.0555556 | null        |
| public     | tda_analysis_history   | id                    | -1         | 0.389061    |
| public     | tda_analysis_history   | performed_at          | -1         | 0.719298    |
| public     | tda_analysis_history   | performed_by          | 1          | 1           |
| public     | tda_answers            | analysis_id           | 3          | 0.674052    |
| public     | tda_answers            | answer_text           | -0.304878  | 0.0196586   |
| public     | tda_answers            | answer_value          | -0.304878  | 0.0196586   |
| public     | tda_answers            | created_at            | 9          | 0.625767    |
| public     | tda_answers            | id                    | -1         | -0.0533796  |
| public     | tda_answers            | question_id           | -0.333333  | 0.0603418   |
| public     | tda_questions          | created_at            | 1          | 1           |
| public     | tda_questions          | id                    | -1         | -0.155814   |
| public     | tda_questions          | is_active             | 1          | 1           |
| public     | tda_questions          | options               | -0.104839  | 0.171101    |
| public     | tda_questions          | order_index           | -0.241935  | -0.356633   |
| public     | tda_questions          | question_text         | -0.370968  | 0.153208    |
| public     | tda_questions          | question_type         | 3          | 0.864132    |
| public     | tda_questions          | required              | 2          | 0.905731    |
| public     | tda_questions          | timeframe             | 10         | 0.544478    |
| public     | tda_timeframe_analyses | analysis_data         | -0.333333  | 0.435373    |
| public     | tda_timeframe_analyses | analysis_id           | 3          | -0.23337    |
| public     | tda_timeframe_analyses | created_at            | 3          | 0.683204    |
| public     | tda_timeframe_analyses | id                    | -1         | -0.0380423  |
| public     | tda_timeframe_analyses | timeframe             | -0.333333  | 0.321913    |
| public     | tda_timeframe_analyses | timeframe_probability | 1          | 1           |
| public     | tda_timeframe_analyses | timeframe_sentiment   | 1          | 1           |
| public     | tda_timeframe_analyses | timeframe_strength    | 1          | 1           |
| public     | tda_timeframe_analyses | updated_at            | 3          | 0.683204    |
| public     | top_down_analyses      | ai_reasoning          | 0          | null        |
| public     | top_down_analyses      | ai_summary            | 0          | null        |
| public     | top_down_analyses      | analysis_date         | -0.357143  | 0.894506    |
| public     | top_down_analyses      | analysis_time         | -0.214286  | 1           |
| public     | top_down_analyses      | completed_at          | 0          | null        |
| public     | top_down_analyses      | confidence_level      | 0          | null        |
| public     | top_down_analyses      | created_at            | -1         | 0.894506    |
| public     | top_down_analyses      | currency_pair         | -0.142857  | -0.0285714  |
| public     | top_down_analyses      | id                    | -1         | 0.243956    |
| public     | top_down_analyses      | notes                 | 0          | null        |
| public     | top_down_analyses      | overall_probability   | 0          | null        |
| public     | top_down_analyses      | risk_level            | 0          | null        |
| public     | top_down_analyses      | status                | 1          | 1           |
| public     | top_down_analyses      | tags                  | 0          | null        |
| public     | top_down_analyses      | trade_recommendation  | 0          | null        |
| public     | top_down_analyses      | updated_at            | -1         | 0.894506    |
| public     | top_down_analyses      | user_id               | 1          | 1           |
| public     | user_presence          | created_at            | -1         | -0.5        |
| public     | user_presence          | id                    | -1         | 0.5         |
| public     | user_presence          | last_seen_at          | -1         | 1           |
| public     | user_presence          | status                | -0.333333  | 1           |
| public     | user_presence          | updated_at            | -1         | -0.5        |
| public     | user_presence          | user_id               | -1         | -0.5        |
| public     | user_settings          | ai_api_key            | -1         | null        |
| public     | user_settings          | chart_timeframe       | -1         | null        |
| public     | user_settings          | created_at            | -1         | null        |
| public     | user_settings          | default_currency      | -1         | null        |
| public     | user_settings          | email_notifications   | -1         | null        |
| public     | user_settings          | email_project_updates | -1         | null        |
| public     | user_settings          | id                    | -1         | null        |
| public     | user_settings          | monthly_reports       | -1         | null        |
| public     | user_settings          | monthly_trade_checkup | -1         | null        |
| public     | user_settings          | notifications_enabled | -1         | null        |
| public     | user_settings          | pips_or_percentage    | -1         | null        |
| public     | user_settings          | public_profile        | -1         | null        |
| public     | user_settings          | quarterly_reports     | -1         | null        |
| public     | user_settings          | recent_trades_count   | -1         | null        |
| public     | user_settings          | share_statistics      | -1         | null        |
| public     | user_settings          | theme                 | -1         | null        |
| public     | user_settings          | timezone              | 0          | null        |
| public     | user_settings          | updated_at            | -1         | null        |
| public     | user_settings          | user_id               | -1         | null        |
| public     | user_settings          | weekly_reports        | -1         | null        |
| public     | user_settings          | yearly_reports        | -1         | null        |
